tmp12 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel2)
tmp13 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel3)
tmp31 <- nrow(MMC_LRT_sim_res_panel1)
tmp32 <- nrow(MMC_LRT_sim_res_panel2)
tmp33 <- nrow(MMC_LRT_sim_res_panel3)
if (nrow(MMC_LRT_sim_res_panel1)<N2){
MMC_LRT_sim_res_panel1 <- rbind(MMC_LRT_sim_res_panel1,MMC_LRT_sim_res_panel1[sample(nrow(MMC_LRT_sim_res_panel1), N2-nrow(MMC_LRT_sim_res_panel1), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel2)<N2){
MMC_LRT_sim_res_panel2 <- rbind(MMC_LRT_sim_res_panel2,MMC_LRT_sim_res_panel2[sample(nrow(MMC_LRT_sim_res_panel2), N2-nrow(MMC_LRT_sim_res_panel2), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel3)<N2){
MMC_LRT_sim_res_panel3 <- rbind(MMC_LRT_sim_res_panel3,MMC_LRT_sim_res_panel3[sample(nrow(MMC_LRT_sim_res_panel3), N2-nrow(MMC_LRT_sim_res_panel3), replace = TRUE),])
}
tmp21 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp22 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp23 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp1[i,] <- cbind(tmp11,tmp21,tmp31)
tmp2[i,] <- cbind(tmp12,tmp22,tmp32)
tmp3[i,] <- cbind(tmp13,tmp23,tmp33)
# ------------- Fill matrix
table2_panel_1[1,i]   <- round((sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_2[1,i]   <- round((sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_3[1,i]   <- round((sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
}
tmp <- rbind(tmp1,tmp2,tmp3)
tmp <- cbind(tmp, abs(tmp[,2] - tmp[,1]))
tmp
table2_panel_1  <- matrix(0,1,nrow(combined_list))
table2_panel_2  <- matrix(0,1,nrow(combined_list))
table2_panel_3   <- matrix(0,1,nrow(combined_list))
table2_rownames <- c('$MMC$-$LRT$')
rownames(table2_panel_1)  <- table2_rownames
rownames(table2_panel_2)  <- table2_rownames
rownames(table2_panel_3)   <- table2_rownames
tmp1 <- matrix(0,12,3)
tmp2 <- matrix(0,12,3)
tmp3 <- matrix(0,12,3)
for (i in 1:nrow(combined_list)){
# ------------- parameter values for this loop
n   <- combined_list[i,1]
phi <- combined_list[i,2]
p22 <- combined_list[i,3]
# ------------- File name and columns titles
# panel 1
file_name_MMC_LRT_panel1  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', FALSE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 2
file_name_MMC_LRT_panel2  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', FALSE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 3
file_name_MMC_LRT_panel3  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# ------------- Read files
MMC_LRT_sim_res_panel1    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel1), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel2    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel2), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel3    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel3), header = TRUE, sep = ",")
tmp11 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel1)
tmp12 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel2)
tmp13 <-sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel3)
tmp31 <- nrow(MMC_LRT_sim_res_panel1)
tmp32 <- nrow(MMC_LRT_sim_res_panel2)
tmp33 <- nrow(MMC_LRT_sim_res_panel3)
if (nrow(MMC_LRT_sim_res_panel1)<N2){
MMC_LRT_sim_res_panel1 <- rbind(MMC_LRT_sim_res_panel1,MMC_LRT_sim_res_panel1[sample(nrow(MMC_LRT_sim_res_panel1), N2-nrow(MMC_LRT_sim_res_panel1), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel2)<N2){
MMC_LRT_sim_res_panel2 <- rbind(MMC_LRT_sim_res_panel2,MMC_LRT_sim_res_panel2[sample(nrow(MMC_LRT_sim_res_panel2), N2-nrow(MMC_LRT_sim_res_panel2), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel3)<N2){
MMC_LRT_sim_res_panel3 <- rbind(MMC_LRT_sim_res_panel3,MMC_LRT_sim_res_panel3[sample(nrow(MMC_LRT_sim_res_panel3), N2-nrow(MMC_LRT_sim_res_panel3), replace = TRUE),])
}
tmp21 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp22 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp23 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp1[i,] <- cbind(tmp11,tmp21,tmp31)
tmp2[i,] <- cbind(tmp12,tmp22,tmp32)
tmp3[i,] <- cbind(tmp13,tmp23,tmp33)
# ------------- Fill matrix
table2_panel_1[1,i]   <- round((sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_2[1,i]   <- round((sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_3[1,i]   <- round((sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
}
tmp <- rbind(tmp1,tmp2,tmp3)
tmp <- cbind(tmp, abs(tmp[,2] - tmp[,1]))
table2_panel_1
table2_panel_2
table2_panel_3
tmp
setwd("/Users/grodriguezrondon/Dropbox/Res/structural_break/MC_LRT/mc_simu/res_files")
# ====================================================================
# ====== TABLE 2: Power of Test H0: k=1 vs. H1: k=2
# ====================================================================
alpha <- 0.05
N <- 99
k1 <- 2
k0 <- 1
N2 <- 1000
eps = '005'
P22_ls <- c(0.90, 0.50)
phi_ls <- c(0.1, 0.9, 1)
n_ls <-  c(100, 200)#,500)
ls <- list()
ls$n <- n_ls
ls$phi <- phi_ls
ls$P22_ls <- P22_ls
combined_list <- expand.grid(ls)
# --------------------------------------------------------------------
# ----- Create Table
# --------------------------------------------------------------------
table2_panel_1  <- matrix(0,1,nrow(combined_list))
table2_panel_2  <- matrix(0,1,nrow(combined_list))
table2_panel_3   <- matrix(0,1,nrow(combined_list))
table2_rownames <- c('$MMC$-$LRT$')
rownames(table2_panel_1)  <- table2_rownames
rownames(table2_panel_2)  <- table2_rownames
rownames(table2_panel_3)   <- table2_rownames
tmp1 <- matrix(0,12,3)
tmp2 <- matrix(0,12,3)
tmp3 <- matrix(0,12,3)
for (i in 1:nrow(combined_list)){
# ------------- parameter values for this loop
n   <- combined_list[i,1]
phi <- combined_list[i,2]
p22 <- combined_list[i,3]
# ------------- File name and columns titles
# panel 1
file_name_MMC_LRT_panel1  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', FALSE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 2
file_name_MMC_LRT_panel2  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', FALSE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 3
file_name_MMC_LRT_panel3  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# ------------- Read files
MMC_LRT_sim_res_panel1    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel1), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel2    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel2), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel3    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel3), header = TRUE, sep = ",")
tmp11 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel1)
tmp12 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel2)
tmp13 <-sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel3)
tmp31 <- nrow(MMC_LRT_sim_res_panel1)
tmp32 <- nrow(MMC_LRT_sim_res_panel2)
tmp33 <- nrow(MMC_LRT_sim_res_panel3)
if (nrow(MMC_LRT_sim_res_panel1)<N2){
MMC_LRT_sim_res_panel1 <- rbind(MMC_LRT_sim_res_panel1,MMC_LRT_sim_res_panel1[sample(nrow(MMC_LRT_sim_res_panel1), N2-nrow(MMC_LRT_sim_res_panel1), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel2)<N2){
MMC_LRT_sim_res_panel2 <- rbind(MMC_LRT_sim_res_panel2,MMC_LRT_sim_res_panel2[sample(nrow(MMC_LRT_sim_res_panel2), N2-nrow(MMC_LRT_sim_res_panel2), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel3)<N2){
MMC_LRT_sim_res_panel3 <- rbind(MMC_LRT_sim_res_panel3,MMC_LRT_sim_res_panel3[sample(nrow(MMC_LRT_sim_res_panel3), N2-nrow(MMC_LRT_sim_res_panel3), replace = TRUE),])
}
tmp21 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp22 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp23 <-sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp1[i,] <- cbind(tmp11,tmp21,tmp31)
tmp2[i,] <- cbind(tmp12,tmp22,tmp32)
tmp3[i,] <- cbind(tmp13,tmp23,tmp33)
# ------------- Fill matrix
table2_panel_1[1,i]   <- round((sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_2[1,i]   <- round((sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_3[1,i]   <- round((sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
}
tmp <- rbind(tmp1,tmp2,tmp3)
tmp <- cbind(tmp, abs(tmp[,2] - tmp[,1]))
tmp
table2_panel_1
table2_panel_2
table2_panel_3
table2_panel_1  <- data.frame(table2_panel_1)
table2_panel_2  <- data.frame(table2_panel_2)
table2_panel_3   <- data.frame(table2_panel_3)
table2_panel_1$split <- "&"
table2_panel_1$end <- "\\"
table2_panel_1  <- table2_panel_1[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_2$split <- "&"
table2_panel_2$end <- "\\"
table2_panel_2  <- table2_panel_2[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_3$split <- "&"
table2_panel_3$end <- "\\"
table2_panel_3  <- table2_panel_3[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_1
table2_panel_1
table2_panel_1
combined_list
table2_panel_2
table2_panel_3
tmp
# ====================================================================
# ====== TABLE 2: Power of Test H0: k=1 vs. H1: k=2
# ====================================================================
alpha <- 0.05
N <- 99
k1 <- 2
k0 <- 1
N2 <- 1000
eps = '005'
P22_ls <- c(0.90, 0.50)
phi_ls <- c(0.1, 0.9, 1)
n_ls <-  c(100, 200)#,500)
ls <- list()
ls$n <- n_ls
ls$phi <- phi_ls
ls$P22_ls <- P22_ls
combined_list <- expand.grid(ls)
# --------------------------------------------------------------------
# ----- Create Table
# --------------------------------------------------------------------
table2_panel_1  <- matrix(0,1,nrow(combined_list))
table2_panel_2  <- matrix(0,1,nrow(combined_list))
table2_panel_3   <- matrix(0,1,nrow(combined_list))
table2_rownames <- c('$MMC$-$LRT$')
rownames(table2_panel_1)  <- table2_rownames
rownames(table2_panel_2)  <- table2_rownames
rownames(table2_panel_3)   <- table2_rownames
tmp1 <- matrix(0,12,3)
tmp2 <- matrix(0,12,3)
tmp3 <- matrix(0,12,3)
for (i in 1:nrow(combined_list)){
# ------------- parameter values for this loop
n   <- combined_list[i,1]
phi <- combined_list[i,2]
p22 <- combined_list[i,3]
# ------------- File name and columns titles
# panel 1
file_name_MMC_LRT_panel1  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', FALSE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 2
file_name_MMC_LRT_panel2  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', FALSE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 3
file_name_MMC_LRT_panel3  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# ------------- Read files
MMC_LRT_sim_res_panel1    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel1), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel2    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel2), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel3    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel3), header = TRUE, sep = ",")
tmp11 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel1)
tmp12 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel2)
tmp13 <-sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel3)
tmp31 <- nrow(MMC_LRT_sim_res_panel1)
tmp32 <- nrow(MMC_LRT_sim_res_panel2)
tmp33 <- nrow(MMC_LRT_sim_res_panel3)
if (nrow(MMC_LRT_sim_res_panel1)<N2){
MMC_LRT_sim_res_panel1 <- rbind(MMC_LRT_sim_res_panel1,MMC_LRT_sim_res_panel1[sample(nrow(MMC_LRT_sim_res_panel1), N2-nrow(MMC_LRT_sim_res_panel1), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel2)<N2){
MMC_LRT_sim_res_panel2 <- rbind(MMC_LRT_sim_res_panel2,MMC_LRT_sim_res_panel2[sample(nrow(MMC_LRT_sim_res_panel2), N2-nrow(MMC_LRT_sim_res_panel2), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel3)<N2){
MMC_LRT_sim_res_panel3 <- rbind(MMC_LRT_sim_res_panel3,MMC_LRT_sim_res_panel3[sample(nrow(MMC_LRT_sim_res_panel3), N2-nrow(MMC_LRT_sim_res_panel3), replace = TRUE),])
}
tmp21 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp22 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp23 <-sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp1[i,] <- cbind(tmp11,tmp21,tmp31)
tmp2[i,] <- cbind(tmp12,tmp22,tmp32)
tmp3[i,] <- cbind(tmp13,tmp23,tmp33)
# ------------- Fill matrix
table2_panel_1[1,i]   <- round((sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_2[1,i]   <- round((sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_3[1,i]   <- round((sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
}
tmp <- rbind(tmp1,tmp2,tmp3)
tmp <- cbind(tmp, abs(tmp[,2] - tmp[,1]))
tmp
table2_panel_1
table2_panel_2
table2_panel_3
table2_panel_1  <- data.frame(table2_panel_1)
table2_panel_2  <- data.frame(table2_panel_2)
table2_panel_3   <- data.frame(table2_panel_3)
table2_panel_1$split <- "&"
table2_panel_1$end <- "\\"
table2_panel_1  <- table2_panel_1[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_2$split <- "&"
table2_panel_2$end <- "\\"
table2_panel_2  <- table2_panel_2[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_3$split <- "&"
table2_panel_3$end <- "\\"
table2_panel_3  <- table2_panel_3[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_1
table2_panel_2
table2_panel_3
# ====================================================================
# ====== TABLE 2: Power of Test H0: k=1 vs. H1: k=2
# ====================================================================
alpha <- 0.05
N <- 99
k1 <- 2
k0 <- 1
N2 <- 1000
eps = '005'
P22_ls <- c(0.90, 0.50)
phi_ls <- c(0.1, 0.9, 1)
n_ls <-  c(100, 200)#,500)
ls <- list()
ls$n <- n_ls
ls$phi <- phi_ls
ls$P22_ls <- P22_ls
combined_list <- expand.grid(ls)
# --------------------------------------------------------------------
# ----- Create Table
# --------------------------------------------------------------------
table2_panel_1  <- matrix(0,1,nrow(combined_list))
table2_panel_2  <- matrix(0,1,nrow(combined_list))
table2_panel_3   <- matrix(0,1,nrow(combined_list))
table2_rownames <- c('$MMC$-$LRT$')
rownames(table2_panel_1)  <- table2_rownames
rownames(table2_panel_2)  <- table2_rownames
rownames(table2_panel_3)   <- table2_rownames
tmp1 <- matrix(0,12,3)
tmp2 <- matrix(0,12,3)
tmp3 <- matrix(0,12,3)
for (i in 1:nrow(combined_list)){
# ------------- parameter values for this loop
n   <- combined_list[i,1]
phi <- combined_list[i,2]
p22 <- combined_list[i,3]
# ------------- File name and columns titles
# panel 1
file_name_MMC_LRT_panel1  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', FALSE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 2
file_name_MMC_LRT_panel2  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', FALSE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 3
file_name_MMC_LRT_panel3  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# ------------- Read files
MMC_LRT_sim_res_panel1    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel1), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel2    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel2), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel3    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel3), header = TRUE, sep = ",")
tmp11 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel1)
tmp12 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel2)
tmp13 <-sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel3)
tmp31 <- nrow(MMC_LRT_sim_res_panel1)
tmp32 <- nrow(MMC_LRT_sim_res_panel2)
tmp33 <- nrow(MMC_LRT_sim_res_panel3)
if (nrow(MMC_LRT_sim_res_panel1)<N2){
MMC_LRT_sim_res_panel1 <- rbind(MMC_LRT_sim_res_panel1,MMC_LRT_sim_res_panel1[sample(nrow(MMC_LRT_sim_res_panel1), N2-nrow(MMC_LRT_sim_res_panel1), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel2)<N2){
MMC_LRT_sim_res_panel2 <- rbind(MMC_LRT_sim_res_panel2,MMC_LRT_sim_res_panel2[sample(nrow(MMC_LRT_sim_res_panel2), N2-nrow(MMC_LRT_sim_res_panel2), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel3)<N2){
MMC_LRT_sim_res_panel3 <- rbind(MMC_LRT_sim_res_panel3,MMC_LRT_sim_res_panel3[sample(nrow(MMC_LRT_sim_res_panel3), N2-nrow(MMC_LRT_sim_res_panel3), replace = TRUE),])
}
tmp21 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp22 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp23 <-sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp1[i,] <- cbind(tmp11,tmp21,tmp31)
tmp2[i,] <- cbind(tmp12,tmp22,tmp32)
tmp3[i,] <- cbind(tmp13,tmp23,tmp33)
# ------------- Fill matrix
table2_panel_1[1,i]   <- round((sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_2[1,i]   <- round((sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_3[1,i]   <- round((sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
}
tmp <- rbind(tmp1,tmp2,tmp3)
tmp <- cbind(tmp, abs(tmp[,2] - tmp[,1]))
tmp
table2_panel_1
table2_panel_2
table2_panel_3
table2_panel_1  <- data.frame(table2_panel_1)
table2_panel_2  <- data.frame(table2_panel_2)
table2_panel_3   <- data.frame(table2_panel_3)
table2_panel_1$split <- "&"
table2_panel_1$end <- "\\"
table2_panel_1  <- table2_panel_1[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_2$split <- "&"
table2_panel_2$end <- "\\"
table2_panel_2  <- table2_panel_2[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_3$split <- "&"
table2_panel_3$end <- "\\"
table2_panel_3  <- table2_panel_3[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
date_loc <- "/Users/grodriguezrondon/Dropbox/Res/papers/MC_LRT_MSM/results/simulations/sim_test_res_h0_1_h1_2/"
alpha <- 0.05
N <- 99
k1 <- 2
k0 <- 1
N2 <- 1000
eps = '005'
P22_ls <- c(0.90, 0.50)
phi_ls <- c(0.1, 0.9, 1)
n_ls <-  c(100, 200)#,500)
ls <- list()
ls$n <- n_ls
ls$phi <- phi_ls
ls$P22_ls <- P22_ls
combined_list <- expand.grid(ls)
# --------------------------------------------------------------------
# ----- Create Table
# --------------------------------------------------------------------
table2_panel_1  <- matrix(0,1,nrow(combined_list))
table2_panel_2  <- matrix(0,1,nrow(combined_list))
table2_panel_3   <- matrix(0,1,nrow(combined_list))
table2_rownames <- c('$MMC$-$LRT$')
rownames(table2_panel_1)  <- table2_rownames
rownames(table2_panel_2)  <- table2_rownames
rownames(table2_panel_3)   <- table2_rownames
tmp1 <- matrix(0,12,3)
tmp2 <- matrix(0,12,3)
tmp3 <- matrix(0,12,3)
for (i in 1:nrow(combined_list)){
# ------------- parameter values for this loop
n   <- combined_list[i,1]
phi <- combined_list[i,2]
p22 <- combined_list[i,3]
# ------------- File name and columns titles
# panel 1
file_name_MMC_LRT_panel1  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', FALSE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 2
file_name_MMC_LRT_panel2  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', FALSE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# panel 3
file_name_MMC_LRT_panel3  <- paste0('MMC_LRT_simulation_',N,'_results_eps_005_power_of_test_h0_1_h1_2_n_',
n,'_phi_',sub('\\.','',phi),'_changeMean_', TRUE,'_changeVar_', TRUE,
'_p22_',sub('\\.','',p22),'_threshold_005_maxiter_100.csv')
# ------------- Read files
MMC_LRT_sim_res_panel1    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel1), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel2    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel2), header = TRUE, sep = ",")
MMC_LRT_sim_res_panel3    <- read.table(paste0(date_loc,file_name_MMC_LRT_panel3), header = TRUE, sep = ",")
tmp11 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel1)
tmp12 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel2)
tmp13 <-sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue<=alpha)/nrow(MMC_LRT_sim_res_panel3)
tmp31 <- nrow(MMC_LRT_sim_res_panel1)
tmp32 <- nrow(MMC_LRT_sim_res_panel2)
tmp33 <- nrow(MMC_LRT_sim_res_panel3)
if (nrow(MMC_LRT_sim_res_panel1)<N2){
MMC_LRT_sim_res_panel1 <- rbind(MMC_LRT_sim_res_panel1,MMC_LRT_sim_res_panel1[sample(nrow(MMC_LRT_sim_res_panel1), N2-nrow(MMC_LRT_sim_res_panel1), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel2)<N2){
MMC_LRT_sim_res_panel2 <- rbind(MMC_LRT_sim_res_panel2,MMC_LRT_sim_res_panel2[sample(nrow(MMC_LRT_sim_res_panel2), N2-nrow(MMC_LRT_sim_res_panel2), replace = TRUE),])
}
if (nrow(MMC_LRT_sim_res_panel3)<N2){
MMC_LRT_sim_res_panel3 <- rbind(MMC_LRT_sim_res_panel3,MMC_LRT_sim_res_panel3[sample(nrow(MMC_LRT_sim_res_panel3), N2-nrow(MMC_LRT_sim_res_panel3), replace = TRUE),])
}
tmp21 <-sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp22 <-sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp23 <-sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2
tmp1[i,] <- cbind(tmp11,tmp21,tmp31)
tmp2[i,] <- cbind(tmp12,tmp22,tmp32)
tmp3[i,] <- cbind(tmp13,tmp23,tmp33)
# ------------- Fill matrix
table2_panel_1[1,i]   <- round((sum(MMC_LRT_sim_res_panel1$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_2[1,i]   <- round((sum(MMC_LRT_sim_res_panel2$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
table2_panel_3[1,i]   <- round((sum(MMC_LRT_sim_res_panel3$MMC_LRT_Pvalue[1:N2]<=alpha)/N2)*100,1)
}
tmp <- rbind(tmp1,tmp2,tmp3)
tmp <- cbind(tmp, abs(tmp[,2] - tmp[,1]))
tmp
table2_panel_1
table2_panel_2
table2_panel_3
table2_panel_1  <- data.frame(table2_panel_1)
table2_panel_2  <- data.frame(table2_panel_2)
table2_panel_3   <- data.frame(table2_panel_3)
table2_panel_1$split <- "&"
table2_panel_1$end <- "\\"
table2_panel_1  <- table2_panel_1[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_2$split <- "&"
table2_panel_2$end <- "\\"
table2_panel_2  <- table2_panel_2[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_3$split <- "&"
table2_panel_3$end <- "\\"
table2_panel_3  <- table2_panel_3[, c("split","X1", "split", "X2", "split", "X3", "split", "X4", "split",
"X5", "split", "X6", "split", "X7", "split", "X8", "split",
"X9", "split", "X10", "split", "X11", "split", "X12", "end")]
table2_panel_1
table2_panel_2
table2_panel_3
