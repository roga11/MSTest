f <- optlst$value
beta[1:(k+1),j] <- bnew
beta[(k+2):(k+1+k1),j] <- HLR_opt_ls_tmp$b1
beta[(k+2+k1),j] <- HLR_opt_ls_tmp$p
if (qbound == FALSE){
beta[(k+3+k1),j] <- HLR_opt_ls_tmp$q
}
diff <- null - clike(bnew, HLR_opt_ls_tmp)
diff <- diff - mean(diff)
se <- as.numeric(sqrt(t(diff)%*%diff))
diff <- (diff/se)
c[j] <- mnull - f
cs[j] <- ((mnull-f)/se)
diffe <- matrix(0, nrow = 1, ncol = reps)
nw <- 0
while (nw<=nwband){
diffe <- diffe+t(diff)%*%eps[(1+nw):(ny+nw),]
draws[(1+nw),] <- apply(rbind(draws[(1+nw),],(diffe/sqrt(1+nw))),2,max)
nw <- nw+1
}
drawsLs[[j]] <- draws
bs <- bnew
}
}
}
out <- list(cs = cs, draws = drawsLS, coefficients = t(beta))
out <- list(cs = cs, draws = drawsLs, coefficients = t(beta))
LR_stat <- max(out$cs)
LR_stat
coef <- as.matrix(out$coefficients[which.max(out$cs),])
out$draws[[which.max(out$cs)]]
dim(out$draws[[which.max(out$cs)]])
t(out$draws[[which.max(out$cs)]])
apply(t(out$draws[[which.max(out$cs)]]),2,sort)
draws <- apply(t(out$draws[[which.max(out$cs)]]),2,sort)
if (con$msvar == FALSE){
signame_tmp_0 <-  "sig"
signame_tmp_1 <-  NULL
}else{
signame_tmp_0 <- "sig_0"
signame_tmp_1 <- "sig_1"
}
if (length(con$ix)>1){
rname_tmp <- c("const_0", paste0("ar", seq(1, (HLR_opt_ls$k-1)),"_0"), signame_tmp_0,
"const_1", paste0("ar", con$ix[2:length(con$ix)]-1,"_1"), signame_tmp_1)
}else{
rname_tmp <- c("const_0", paste0("ar", seq(1, (HLR_opt_ls$k-1)),"_0"), signame_tmp_0,
"const_1", signame_tmp_1)
}
rname_tmp <- c(rname_tmp, "p")
if (con$qbound == FALSE){
rname_tmp <- c(rname_tmp, "q")
}
rownames(coef) <- rname_tmp
draws>LR_stat
colMeans(draws>LR_stat)
round(cr*reps)
cr <- c(0.9, 0.95, 0.99)
round(cr*reps)
draws[round(cr*reps),]
as.matrix(draws[round(cr*reps),])
cu <- as.matrix(draws[round(cr*reps),])
pvalue
pvalue <- colMeans(draws>LR_stat)
pvalue
pvalue <- as.matrix(colMeans(draws>LR_stat))
pvalue
cu <- t(as.matrix(draws[round(cr*reps),]))
cu
colnames(cu) <- c('0.90 %', '0.95 %', '0.99 %')
cu
0:(con$nwband)
paste0("M = ",0:(con$nwband))
rownames(cu) <- paste0("M = ",0:(con$nwband))
cu
rownames(pvalue) <- paste0("M = ",0:(con$nwband))
pvalue
HLRTest_output <- list(mdl_h0 = mdl_h0, LR0 = LR_stat, LRN = draws, LR_cv = cu,
pval = pvalue, coef = coef)
HLRTest_output
colnames(draws) <- paste0("M = ",0:(con$nwband))
draws
HLRTest_output <- list(mdl_h0 = mdl_h0, LR0 = LR_stat, LRN = draws, LR_cv = cu,
pval = pvalue, coef = coef)
class(HLRTest_output) <- "HLRTest"
lowb
lowb <- rep(NULL, length(b))
lowb
b <- c(mdl_h0$coef,mdl_h0$stdev)
b
lowb <- rep(NULL, length(b))
lowb
length(b)
rep(NULL, length(b))
rep(1, length(b))
rep(NULL, length(b))
rep(-Inf, length(b))
lowb[length(b)] <- HLR_opt_ls$var_min
lowb
lowb <- rep(-Inf, length(b))
lowb[length(b)] <- HLR_opt_ls$var_min
lowb
length(b)
lowb[length(b)]
HLR_opt_ls$var_min
HLR_opt_ls$sig_min
lowb[length(b)] <- HLR_opt_ls$sig_min
lowb
uppb <- rep(Inf, length(b))
bs <- b # starting values for optim
optlst <- optim(bs, mclike, dmclike, HLR_opt_ls = HLR_opt_ls_tmp, method = 'BFGS', lower = lowb, upper = uppb)
optlst <- optim(bs, mclike, dmclike, HLR_opt_ls = HLR_opt_ls_tmp, method = 'L-BFGS-B', lower = lowb, upper = uppb)
optlst
library(MSTest)
devtools::document()
devtools::document()
library(MSTest)
hlrt_control  <- list(ix = 1,
p_gridsize = 17,
p_stepsize = 0.05)
st <- Sys.time()
hlrt <- HLRTest(Y, p = 4, control = hlrt_control)
y84 <- as.matrix(hamilton84GNP$GNP_logdiff)
Y <- y84
hlrt_control  <- list(ix = 1,
p_gridsize = 17,
p_stepsize = 0.05)
st <- Sys.time()
hlrt <- HLRTest(Y, p = 4, control = hlrt_control)
devtools::document()
library(MSTest)
y84 <- as.matrix(hamilton84GNP$GNP_logdiff)
Y <- y84
hlrt_control  <- list(ix = 1,
p_gridsize = 17,
p_stepsize = 0.05)
st <- Sys.time()
hlrt <- HLRTest(Y, p = 4, control = hlrt_control)
library(MSTest)
y84 <- as.matrix(hamilton84GNP$GNP_logdiff)
Y <- y84
hlrt_control  <- list(ix = 1,
p_gridsize = 17,
p_stepsize = 0.05)
st <- Sys.time()
hlrt <- HLRTest(Y, p = 4, control = hlrt_control)
end <- Sys.time() - st
end
hlrt
HLRTest_output
hlrt
mdl <- hlrt
cat("\nRestricted Model\n")
frame_tmp <- data.frame(coef = mdl$mdl_h0$theta)
if (mdl$mdl_h0$control$getSE==TRUE){
frame_tmp["s.e."] <- mdl$mdl_h0$theta_se
}
rownames(frame_tmp) <- names(mdl$mdl_h0$theta)
mdl$control$msvar
con
contorl
con <- list(ix = 1,
msvar = FALSE,
qbound = FALSE,
gridsize = 20,
p_gridsize = 12,
p_stepsize = 0.075,
mugrid_from = 0.1,
mugrid_by  = 0.1,
siggrid_from = 0.1,
siggrid_by  = 0.1,
N = 1000,
nwband  = 4,
sig_min = 0.01)
# Perform some checks for controls
nmsC <- names(con)
con[(namc <- names(control))] <- control
control = list()
con <- list(ix = 1,
msvar = FALSE,
qbound = FALSE,
gridsize = 20,
p_gridsize = 12,
p_stepsize = 0.075,
mugrid_from = 0.1,
mugrid_by  = 0.1,
siggrid_from = 0.1,
siggrid_by  = 0.1,
N = 1000,
nwband  = 4,
sig_min = 0.01)
# Perform some checks for controls
nmsC <- names(con)
con[(namc <- names(control))] <- control
if(length(noNms <- namc[!namc %in% nmsC])){
warning("unknown names in control: ", paste(noNms,collapse=", "))
}
# Estimate Model under Null Hypothesis
if(p>0){
mdl_h0 <- ARmdl(Y, p, list(const = TRUE, getSE = TRUE))
}else if(p == 0){
mdl_h0 <- Nmdl(Y, list(const = TRUE, getSE = TRUE))
}else{
stop("Value for 'p' must be an integer >=0.")
}
p=4
con <- list(ix = 1,
msvar = FALSE,
qbound = FALSE,
gridsize = 20,
p_gridsize = 12,
p_stepsize = 0.075,
mugrid_from = 0.1,
mugrid_by  = 0.1,
siggrid_from = 0.1,
siggrid_by  = 0.1,
N = 1000,
nwband  = 4,
sig_min = 0.01)
# Perform some checks for controls
nmsC <- names(con)
con[(namc <- names(control))] <- control
if(length(noNms <- namc[!namc %in% nmsC])){
warning("unknown names in control: ", paste(noNms,collapse=", "))
}
# Estimate Model under Null Hypothesis
if(p>0){
mdl_h0 <- ARmdl(Y, p, list(const = TRUE, getSE = TRUE))
}else if(p == 0){
mdl_h0 <- Nmdl(Y, list(const = TRUE, getSE = TRUE))
}else{
stop("Value for 'p' must be an integer >=0.")
}
mdl$control = con
(mdl$control$msvar)
mdl$LR0
mdl$LR_cv
mdl$pval
rbind(mdl$LR0, mdl$LR_cv, mdl$pval)
rbind(mdl$LR0, mdl$LR_cv, mdl$pval)
mdl$LR0
rbind(as.matrix(mdl$LR0), mdl$LR_cv, mdl$pval)
cbind(mdl$LR0, mdl$LR_cv, mdl$pval)
out <- data.frame(cbind(mdl$LR0, mdl$LR_cv, mdl$pval))
colnames(out) <- c("test-stat", names(mdl$supTS_cv), "p-value")
out
digits = getOption("digits")
cat("\nRestricted Model\n")
frame_tmp <- data.frame(coef = mdl$mdl_h0$theta)
if (mdl$mdl_h0$control$getSE==TRUE){
frame_tmp["s.e."] <- mdl$mdl_h0$theta_se
}
rownames(frame_tmp) <- names(mdl$mdl_h0$theta)
print(format(signif(frame_tmp, max(1L, digits - 2L))))
cat(paste("\nlog-likelihood = "),mdl$mdl_h0$logLike)
cat(paste("\nAIC = "),mdl$mdl_h0$AIC)
cat(paste("\nBIC = "),mdl$mdl_h0$BIC)
cat("\n")
if (mdl$control$msvar){
cat("\nHansen (1992) Likelihood Ratio Bound Test -  Switch in Mean and Variance\n")
}else{
cat("\nHansen (1992) Likelihood Ratio Bound Test -  Switch in Mean only\n")
}
out <- data.frame(cbind(mdl$LR0, mdl$LR_cv, mdl$pval))
colnames(out) <- c("test-stat", names(mdl$supTS_cv), "p-value")
print(format(signif(out, max(1L, digits - 2L))))
invisible(mdl)
USGNP <- read.table('inst/extdata/GNP22.csv', sep = ',', header = T)
USGNP[2:nrow(USGNP),3] <- diff(log(USGNP[,2]))*100
USGNP <- USGNP[2:nrow(USGNP), c(1,3,2)]
colnames(USGNP) <- c('DATE','GNP_logdiff','GNP')
usethis::use_data(USGNP, overwrite = TRUE)
GNPC96 <- read.table('inst/extdata/GNPC96.txt', sep = ',', header = F)
#setwd(paste0(Dir,'/MSTest/data'))
date <- seq(as.Date("1951/1/1"), as.Date("2010/10/1"), "quarter")
GNP_change = 100*diff(log(GNPC96$V1))
chp10GNP <- data.frame(date[2:length(date)],GNP_change,GNPC96$V1[2:length(date)])
colnames(chp10GNP) <- c('DATE','GNP_logdiff','GNP')
#save(chp10GNP,file = "chp10GNP")
usethis::use_data(chp10GNP, overwrite = TRUE)
hamilton84GNP <- read.table('inst/extdata/GNP82.DAT', header = F)
#setwd(paste0(Dir,'/MSTest/data'))
date <- seq(as.Date("1951/1/1"), as.Date("1984/10/1"), "quarter")
GNP <- matrix(0, dim(hamilton84GNP)[1]*dim(hamilton84GNP)[2], 1 )
xk <- 1
for (xi in 1:dim(hamilton84GNP)[1] ){
for (xj in 1:dim(hamilton84GNP)[2]){
GNP[xk] <- hamilton84GNP[xi,xj]
xk <- xk +1
}
}
date <- date[2:length(date)]
Tsize <- length(GNP)
Y <- matrix(0, Tsize-1, 1)
Y <- 100*( log(GNP[2:Tsize]) -log(GNP[1:(Tsize-1)]) )
hamilton84GNP <- data.frame(date,Y,GNP[2:Tsize])
colnames(hamilton84GNP) <- c('DATE','GNP_logdiff','GNP')
#save(hamilton84GNP,file = "hamilton84GNP")
usethis::use_data(hamilton84GNP, overwrite = TRUE)
usethis::use_data_raw("MSTest_raw_pckg_data")
devtools::document()
devtools::document()
devtools::document()
devtools::document()
version
devtools::document()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(MSTest)
library(MSTest)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
foreach
library(foreach)
library(numDeriv)
library(numDeriv)
devtools::document()
devtools::document()
devtools::document()
devtools::document()
y84 <- as.matrix(hamilton84GNP$GNP_logdiff)
Y <- y84
hlrt_control  <- list(ix = 1,
p_gridsize = 17,
p_stepsize = 0.05)
st <- Sys.time()
hlrt <- HLRTest(Y, p = 4, control = hlrt_control)
end <- Sys.time() - st
end
hlrt
mdl = hlrt
out <- data.frame(cbind(mdl$LR0, mdl$LR_cv, mdl$pval))
out
colnames(out) <- c("test-stat", names(mdl$supTS_cv), "p-value")
out
colnames(out) <- c("test-stat", names(mdl$LR_cv), "p-value")
out
out <- data.frame(cbind(mdl$LR0, mdl$LR_cv, mdl$pval))
colnames(out) <- c("test-stat", names(mdl$LR_cv), "p-value")
out
names(mdl$LR_cv)
mdl$LR_cv
rownames(mdl$LR_cv)
colnames(out) <- c("test-stat", rownames(mdl$LR_cv), "p-value")
out
colnames(out) <- c("test-stat", rownames(mdl$LR_cv), "p-value")
out
mdl$LR_cv
colnames(out) <- c("test-stat", colnames(mdl$LR_cv), "p-value")
out
devtools::document()
library(MSTest)
hlrt
stats::rnorm()
stats::rnorm(100)
stats::nlswi
wi
simdist_N<-100
Tsize<-100
S_N2  <- sim_DLmoments(Tsize, simdist_N)
x     <- apply(S_N2, 2, sort)
Fx    <- approx_dist_loop(x)
a_start <- 0.01
b_start <- 0.01
# initiate matrix
a<-matrix(nrow=1,ncol=0)
b<-matrix(nrow=1,ncol=0)
i=1
mdl <- stats::nls(Fx[,i]~exp(alpha+beta*x[,i])/(1+exp(alpha+beta*x[,i])),
start=list(alpha=a_start,beta=b_start))
mdl
coef(mdl)
stats::coef()
stats::coef(mdl)
devtools::document()
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
roxygen2::roxygenise()
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
rlang::get()
nloptr::slsqp()
MSVARmdl_mle_env <- rlang::env()
MSVARmdl_mle_env$p <- 4
get("p", envir = MSVARmdl_mle_env)
rlang::get("p", envir = MSVARmdl_mle_env)
rlang::get_env("p", envir = MSVARmdl_mle_env)
get("p", envir = MSVARmdl_mle_env)
devtools::document()
library(MSTest)
roxygen2::roxygenise()
roxygen2::roxygenise()
devtools::document()
roxygen2::roxygenize()
roxygen2::roxygenise()
devtools::document()
roxygen2::namespace_roclet()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
use_build_ignore(NEWS.md)
usethis::use_build_ignore(NEWS.md)
usethis::use_build_ignore(NEWS)
usethis::use_build_ignore(NEWS, escape = TRUE)
usethis::use_build_ignore("NEWS.md")
usethis::use_build_ignore("cran-comments.md")
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
library(MSTest)
devtools::document()
library(MSTest)
library(MSTest)
GNP
MSTest::USGNP
devtools::document()
warnings()
devtools::document()
warnings()
devtools::document()
devtools::document()
devtools::document()
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
devtools::document()
devtools::document()
library(MSTest)
devtools::document()
library(MSTest)
library(MSTest)
optim_options$h
"lower" in optim_options
("lower" in optim_options)
("lower" %in% optim_options)
optim_options <- list()
("lower" %in% optim_options)
(("upper" %in% optim_options)==FALSE)
library(MSTest)
devtools::document()
library(MSTest)
library(MSTest)
library(MSTest)
set.seed(123)
# Define DGP
mdl_hmm <- list(n     = 500,
q     = 2,
mu    = rbind(c(5, -2),
c(10, 2)),
sigma = list(rbind(c(5.0, 1.5),
c(1.5, 1.0)),
rbind(c(7.0, 3.0),
c(3.0, 2.0))),
k     = 2,
P     = rbind(c(0.90, 0.10),
c(0.10, 0.90)))
# Simulate process using simuHMM() function
y_hmm_simu <- simuHMM(mdl_hmm)
library(MSTest)
set.seed(123)
# Define DGP
mdl_hmm <- list(n     = 500,
q     = 2,
mu    = rbind(c(5, -2),
c(10, 2)),
sigma = list(rbind(c(5.0, 1.5),
c(1.5, 1.0)),
rbind(c(7.0, 3.0),
c(3.0, 2.0))),
k     = 2,
P     = rbind(c(0.90, 0.10),
c(0.10, 0.90)))
# Simulate process using simuHMM() function
y_hmm_simu <- simuHMM(mdl_hmm)
y_hmm_mdl <- HMmdl(y_hmm_simu$y, k = 2)
y_hmm_mdl
y_hmm_simu$y
