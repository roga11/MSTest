ls$phi <- phi_ls
ls$mu_ls <- mu_ls
ls$stdev_ls <- stdev_ls
ls$P22_ls <-P22_ls
combined_list <- expand.grid(ls)
combined_list["mu_1"] = -1
combined_list["stdev_1"] = 1
combined_list <- combined_list[((combined_list["mu_ls"]==0) + (combined_list["mu_1"]==0) + (combined_list["stdev_ls"]==1) + (combined_list["stdev_1"]==1))!=4,]
row.names(combined_list) <- NULL
combined_list
ar <- 1
n_ls <- c(200)    #100, 200, 500
mu_ls <- c(1)
stdev_ls <- c(1)
phi_ls <- c(0.1)  # 0.1, 0.9, 1.0
P22_ls <- c(0.50) # 0.9, 0.5
#P2 <- rbind(c(0.90, 0.10),c(0.10, 0.90))
ls <- list()
ls$n <- n_ls
ls$phi <- phi_ls
ls$mu_ls <- mu_ls
ls$stdev_ls <- stdev_ls
ls$P22_ls <-P22_ls
combined_list <- expand.grid(ls)
combined_list["mu_1"] = -1
combined_list["stdev_1"] = 1
combined_list <- combined_list[((combined_list["mu_ls"]==0) + (combined_list["mu_1"]==0) + (combined_list["stdev_ls"]==1) + (combined_list["stdev_1"]==1))!=4,]
row.names(combined_list) <- NULL
# ---------------------------------------
# Size of Test H0: k=2 vs. H1: k=3
# ---------------------------------------
k1 <- 3
k0 <- 2
ar_mdl_k2 <- list()
ar_mdl_k2[["ar"]] <- ar
ar_mdl_k2[["k"]] <- k0
print(combined_list)
start = 1
i=1
n <- combined_list[i,1]
phi <- combined_list[i,2]
mu_1 <- combined_list[i,6]
mu_2 <- combined_list[i,3]
stdev_1 <- combined_list[i,7]
stdev_2 <- combined_list[i,4]
p22 <- combined_list[i,5]
# ------------- Model
ar_mdl_k2[["n"]] <- n
ar_mdl_k2[["phi"]] <- phi
ar_mdl_k2[["mu"]] <- c(mu_1,mu_2)
ar_mdl_k2[["stdev"]] <- c(stdev_1,stdev_2)
ar_mdl_k2[["P"]] <- cbind(c(0.5,0.50),c(1-p22,p22))
msmu <- mu_1!=mu_2
msvar <- stdev_1!=stdev_2
ar_mdl_k2
ar <- 1
n_ls <- c(200)    #100, 200, 500
mu_ls <- c(1)
stdev_ls <- c(1)
phi_ls <- c(0.5)  # 0.1, 0.9, 1.0
P22_ls <- c(0.50) # 0.9, 0.5
#P2 <- rbind(c(0.90, 0.10),c(0.10, 0.90))
ls <- list()
ls$n <- n_ls
ls$phi <- phi_ls
ls$mu_ls <- mu_ls
ls$stdev_ls <- stdev_ls
ls$P22_ls <-P22_ls
combined_list <- expand.grid(ls)
combined_list["mu_1"] = -1
combined_list["stdev_1"] = 1
combined_list <- combined_list[((combined_list["mu_ls"]==0) + (combined_list["mu_1"]==0) + (combined_list["stdev_ls"]==1) + (combined_list["stdev_1"]==1))!=4,]
row.names(combined_list) <- NULL
# ---------------------------------------
# Size of Test H0: k=2 vs. H1: k=3
# ---------------------------------------
k1 <- 3
k0 <- 2
# ====================================================================
# ====== Model
# ====================================================================
ar_mdl_k2 <- list()
ar_mdl_k2[["ar"]] <- ar
ar_mdl_k2[["k"]] <- k0
print(combined_list)
start = 1
i=1
n <- combined_list[i,1]
phi <- combined_list[i,2]
mu_1 <- combined_list[i,6]
mu_2 <- combined_list[i,3]
stdev_1 <- combined_list[i,7]
stdev_2 <- combined_list[i,4]
p22 <- combined_list[i,5]
# ------------- Model
ar_mdl_k2[["n"]] <- n
ar_mdl_k2[["phi"]] <- phi
ar_mdl_k2[["mu"]] <- c(mu_1,mu_2)
ar_mdl_k2[["stdev"]] <- c(stdev_1,stdev_2)
ar_mdl_k2[["P"]] <- cbind(c(0.5,0.50),c(1-p22,p22))
msmu <- mu_1!=mu_2
msvar <- stdev_1!=stdev_2
ar_mdl_k2
con <- list(N = 99,
maxit = 500,
thtol = 1e-6,
burnin = 200,
getSE = FALSE,
converge_check = "both",
init_val_try = 1,
init_val_try_dist = 1,
finite_max_init = 100,
dist_converge_iter = 100,
workers = 0)
# Perform some checks for controls
nmsC <- names(con)
con[(namc <- names(control))] <- control
y_out <- simuMSAR(ar_mdl_k2, type="markov")
Y<- y_out$y
st <- proc.time()
mdl_h0 <- MSARmdl(Y, ar, k0, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], con[["init_val_try"]])
mdl_h1 <- MSARmdl(Y, ar, k1, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], con[["init_val_try"]])
end1 <- proc.time() - st
logL0 <- mdl_h0[["logLike"]]
logL1 <- mdl_h1[["logLike"]]
theta_h0 <- mdl_h0[["theta"]]
theta_h1 <- mdl_h1[["theta"]]
LRT_0 <- -2*(logL0-logL1)
end1
LRT_0
mdl_h1$trace[[1]]$logLike
mdl_h1$trace[[2]]$logLike
mdl_h1$trace[[3]]$logLike
mdl_h1$trace[[4]]$logLike
mdl_h1$trace[[5]]$logLike
mdl_h1$logLike
mdl_h1$trace[[6]]$logLike
mdl_h0$stdev <- c(mdl_h0$stdev,mdl_h0$stdev)
st <- proc.time()
y0_out = simuMSAR(mdl_h0, 'markov', 200)
y0 = y0_out[["y"]]
mdl_h0_tmp = MSARmdl(y0, ar, k0, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], con[["init_val_try"]])
mdl_h1_tmp = MSARmdl(y0, ar, k1, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], con[["init_val_try"]])
end2 <- proc.time() - st
l_0 = mdl_h0_tmp[["logLike"]]
l_1 = mdl_h1_tmp[["logLike"]]
LRT_i = -2*(l_0 - l_1)
end2
LRT_i
mdl_h0$stdev <- c(mdl_h0$stdev,mdl_h0$stdev)
st <- proc.time()
y0_out = simuMSAR(mdl_h0, 'markov', 200)
y0 = y0_out[["y"]]
mdl_h0_tmp = MSARmdl(y0, ar, k0, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], con[["init_val_try"]])
mdl_h1_tmp = MSARmdl(y0, ar, k1, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], con[["init_val_try"]])
end2 <- proc.time() - st
l_0 = mdl_h0_tmp[["logLike"]]
l_1 = mdl_h1_tmp[["logLike"]]
LRT_i = -2*(l_0 - l_1)
end2
LRT_i
LRT_i
st <- proc.time()
y0_out = simuMSAR(mdl_h0, 'markov', 200)
y0 = y0_out[["y"]]
mdl_h0_tmp = MSARmdl(y0, ar, k0, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
mdl_h1_tmp = MSARmdl(y0, ar, k1, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
end2 <- proc.time() - st
l_0 = mdl_h0_tmp[["logLike"]]
l_1 = mdl_h1_tmp[["logLike"]]
LRT_i = -2*(l_0 - l_1)
end2
LRT_i
st <- proc.time()
y0_out = simuMSAR(mdl_h0, 'markov', 200)
y0 = y0_out[["y"]]
mdl_h0_tmp = MSARmdl(y0, ar, k0, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
mdl_h1_tmp = MSARmdl(y0, ar, k1, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
end2 <- proc.time() - st
l_0 = mdl_h0_tmp[["logLike"]]
l_1 = mdl_h1_tmp[["logLike"]]
LRT_i = -2*(l_0 - l_1)
end2
LRT_i
st <- proc.time()
y0_out = simuMSAR(mdl_h0, 'markov', 200)
y0 = y0_out[["y"]]
mdl_h0_tmp = MSARmdl(y0, ar, k0, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
mdl_h1_tmp = MSARmdl(y0, ar, k1, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
end2 <- proc.time() - st
l_0 = mdl_h0_tmp[["logLike"]]
l_1 = mdl_h1_tmp[["logLike"]]
LRT_i = -2*(l_0 - l_1)
end2
LRT_i
st <- proc.time()
y0_out = simuMSAR(mdl_h0, 'markov', 200)
y0 = y0_out[["y"]]
mdl_h0_tmp = MSARmdl(y0, ar, k0, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
mdl_h1_tmp = MSARmdl(y0, ar, k1, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
end2 <- proc.time() - st
l_0 = mdl_h0_tmp[["logLike"]]
l_1 = mdl_h1_tmp[["logLike"]]
LRT_i = -2*(l_0 - l_1)
end2
LRT_i
st <- proc.time()
y0_out = simuMSAR(mdl_h0, 'markov', 200)
y0 = y0_out[["y"]]
mdl_h0_tmp = MSARmdl(y0, ar, k0, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
mdl_h1_tmp = MSARmdl(y0, ar, k1, msmu, msvar, con[["maxit"]], con[["thtol"]], con[["getSE"]], con[["finite_max_init"]], 1)
end2 <- proc.time() - st
l_0 = mdl_h0_tmp[["logLike"]]
l_1 = mdl_h1_tmp[["logLike"]]
LRT_i = -2*(l_0 - l_1)
end2
LRT_i
cbind(c(0.5,0.5),c(0.5,0.5))
cbind(c(0.1,0.9),c(0.5,0.5))
cbind(c(0.7,0.3),c(0.3,0.7))
workers <- 6
N <- 99
Nsim <- 100
control <- list(N = N,
maxit = 1000,
thtol = 1e-6,
finite_max_init = 100,
init_val_try = 30,
init_val_try_dist = 10,
dist_converge_iter = 1,
workers=workers)
k1 <- 3
k0 <- 2
Model1 <- list(ar = 1,
mu = c(-1,1),
stdev = 1,
phi = 0.5,
k = k0)
Model2 <- list(ar = 1,
mu = c(-1,1),
stdev = c(0.9,1.2),
phi = 0.5,
k = k0)
n_ls <- 200
#n_ls <- c(200,500)
P_ls <- cbind(c(0.5,0.5),c(0.5,0.5))
#P_ls <- list(cbind(c(0.5,0.5),c(0.5,0.5)),
#            cbind(c(0.7,0.3),c(0.3,0.7)))
length(n_ls)
P_ls <- list(cbind(c(0.5,0.5),c(0.5,0.5)),
cbind(c(0.7,0.3),c(0.3,0.7)))
length(P_ls)
P_ls <- list(cbind(c(0.5,0.5),c(0.5,0.5)))
length(P_ls)
Models <- list(list(ar = 1,
mu = c(-1,1),
stdev = 1,
phi = 0.5,
k = k0),
list(ar = 1,
mu = c(-1,1),
stdev = c(0.9,1.2),
phi = 0.5,
k = k0))
length(Models)
Models <- list(list(ar = 1,
mu = c(-1,1),
stdev = 1,
phi = 0.5,
k = k0))
length(Models)
n_ls <- 200
length(n_ls)
length(P_ls)
i=1
Models[[i]]
Models[[i]]$mu
Models[[i]]$stdev
Models <- list(list(ar = 1,
mu = c(-1,1),
stdev = c(1,1),
phi = 0.5,
k = k0))
Models[[i]]$stdev
all(Models[[i]]$stdev)
diff(Models[[i]]$stdev)
all(diff(Models[[i]]$stdev)==0)
all(diff(Models[[i]]$stdev)==0)==FALSE
msvar = all(diff(Models[[i]]$stdev)==0)==FALSE
msvar
msmu = TRUE
file_name <-paste0('LMC_LRT_simulation_',N,'_results_size_of_test_h0_',k0,'_h1_',k1,
'_n_',n,'_phi_',sub('\\.','',phi),'_changeMean_',msmu,'_changeVar_',msvar,
'_p22_',sub('\\.','',p22),'_inittry_',control$init_val_try,'_inittrydist_',control$init_val_try_dist,'.txt')
xn=1
xp=1
Models[[i]]$n <- n_ls(xn)
n_ls <- 200
n_ls(xn)
n_ls[xn]
Models[[i]]$n <- n_ls[xn]
Models[[i]]$n
P_ls[[xp]]
Models[[i]]$P <- P_ls[[xp]]
msmu = TRUE
msvar = all(diff(Models[[i]]$stdev)==0)==FALSE
file_name <-paste0('LMC_LRT_simulation_',N,'_results_size_of_test_h0_',k0,'_h1_',k1,
'_n_',n,'_phi_',sub('\\.','',phi),'_changeMean_',msmu,'_changeVar_',msvar,
'_p22_',sub('\\.','',p22),'_inittry_',control$init_val_try,'_inittrydist_',control$init_val_try_dist,'.txt')
Models[[i]]$P[1,1]
p22 <- Models[[i]]$P[1,1]
Models[[i]]$n <- n_ls[xn]
Models[[i]]$P <- P_ls[[xp]]
p22 <- Models[[i]]$P[1,1]
msmu = TRUE
msvar = all(diff(Models[[i]]$stdev)==0)==FALSE
file_name <-paste0('LMC_LRT_simulation_',N,'_results_size_of_test_h0_',k0,'_h1_',k1,
'_n_',n_ls[xn],'_phi_',sub('\\.','',phi),'_changeMean_',msmu,'_changeVar_',msvar,
'_p22_',sub('\\.','',p22),'_inittry_',control$init_val_try,'_inittrydist_',control$init_val_try_dist,'.txt')
phi <- Models[[i]]$phi
phi
file_name <-paste0('LMC_LRT_simulation_',N,'_results_size_of_test_h0_',k0,'_h1_',k1,
'_n_',n_ls[xn],'_phi_',sub('\\.','',phi),'_changeMean_',msmu,'_changeVar_',msvar,
'_p22_',sub('\\.','',p22),'_inittry_',control$init_val_try,'_inittrydist_',control$init_val_try_dist,'.txt')
file_name
Models[[i]]
workers <- 9
N <- 99
Nsim <- 100
control <- list(N = N,
maxit = 1000,
thtol = 1e-6,
finite_max_init = 100,
init_val_try = 30,
init_val_try_dist = 10,
dist_converge_iter = 1,
workers=workers)
# ====================================================================
# ====== Model Params (Kasahara & Shitmotsu 2018)
# ====================================================================
# ---------------------------------------
# Size of Test H0: k=2 vs. H1: k=3
# ---------------------------------------
k1 <- 3
k0 <- 2
Models <- list(list(ar = 1,
mu = c(-1,1),
stdev = c(1,1),
phi = 0.5,
k = k0))
#list(ar = 1,
#      mu = c(-1,1),
#     stdev = c(0.9,1.2),
#    phi = 0.5,
#   k = k0))
n_ls <- c(200) # 200, 500
P_ls <- list(cbind(c(0.5,0.5),c(0.5,0.5)),
cbind(c(0.7,0.3),c(0.3,0.7)))
length(Models)
length(n_ls)
length(P_ls)
Models[[i]]$n <- n_ls[xn]
Models[[i]]$P <- P_ls[[xp]]
p22 <- Models[[i]]$P[1,1]
phi <- Models[[i]]$phi
msmu = TRUE
msvar = all(diff(Models[[i]]$stdev)==0)==FALSE
file_name <-paste0('LMC_LRT_simulation_',N,'_results_size_of_test_h0_',k0,'_h1_',k1,
'_n_',n_ls[xn],'_phi_',sub('\\.','',phi),'_changeMean_',msmu,'_changeVar_',msvar,
'_p22_',sub('\\.','',p22),'_inittry_',control$init_val_try,'_inittrydist_',control$init_val_try_dist,'_KS18.txt')
res_line <- paste0("Iteration,","Attempts,","TimeSpent,","LMC_LRT_Pvalue")
Models
y_out <- simuMSAR(Models[[i]], type="markov")
N <- 99
Nsim <- 100
control <- list(N = N,
maxit = 1000,
thtol = 1e-6,
finite_max_init = 100,
init_val_try = 30,
init_val_try_dist = 10,
dist_converge_iter = 1
)
k1 <- 3
k0 <- 2
Models <- list(list(ar = 1,
mu = c(-1,1),
stdev = c(1,1),
phi = 0.5,
k = k0))
#list(ar = 1,
#      mu = c(-1,1),
#     stdev = c(0.9,1.2),
#    phi = 0.5,
#   k = k0))
n_ls <- c(200) # 200, 500
P_ls <- list(cbind(c(0.5,0.5),c(0.5,0.5)),
cbind(c(0.7,0.3),c(0.3,0.7)))
i=1
xn=1
xp=1
Models[[i]]$n <- n_ls[xn]
Models[[i]]$P <- P_ls[[xp]]
p22 <- Models[[i]]$P[1,1]
phi <- Models[[i]]$phi
msmu = TRUE
msvar = all(diff(Models[[i]]$stdev)==0)==FALSE
file_name <-paste0('LMC_LRT_simulation_',N,'_results_size_of_test_h0_',k0,'_h1_',k1,
'_n_',n_ls[xn],'_phi_',sub('\\.','',phi),'_changeMean_',msmu,'_changeVar_',msvar,
'_p22_',sub('\\.','',p22),'_inittry_',control$init_val_try,'_inittrydist_',control$init_val_try_dist,'_KS18.txt')
res_line <- paste0("Iteration,","Attempts,","TimeSpent,","LMC_LRT_Pvalue")
LRTest_out <- NULL
attempt <- 0
startT <- proc.time()
y_out <- simuMSAR(Models[[i]], type="markov")
attempt <- attempt + 1
LRTest_out <- MCLRTest(y_out$y, ar, k0, k1, msmu, msvar, control = control)
msvar
msmu
k1
k0
ar
Models <- list(list(ar = 1,
mu = c(-1,1),
stdev = c(1,1),
phi = 1,
k = k0))
n_ls <- c(100) # 100, 200, 500
P_ls <- list(cbind(c(0.5,0.5),c(0.5,0.5)),
cbind(c(0.7,0.3),c(0.3,0.7)))
y_out <- simuMSAR(Models[[i]], type="markov")
Models[[i]]$n <- n_ls[xn]
Models[[i]]$P <- P_ls[[xp]]
p22 <- Models[[i]]$P[1,1]
phi <- Models[[i]]$phi
msmu = TRUE
msvar = all(diff(Models[[i]]$stdev)==0)==FALSE
y_out <- simuMSAR(Models[[i]], type="markov")
Models[[1]]$stdev
Models[[1]]$stdev <-c(1,2)
y_out <- simuMSAR(Models[[i]], type="markov")
MSARmdl(y_out$y,1,2,TRUE,TRUE)
out <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out$mu
out$stdev
out$P
out$logLike
out <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out$logLike
out <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out$logLike
out <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out$logLike
out <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out$logLike
out <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out$logLike
out <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out$logLike
out$stdev
out$mu
out$P
out$phi
out2 <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out2$logLike
out2$iterations
out2 <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out2$logLike
out2$phi
Models[[1]]$mu
Models[[1]]$mu <-c(0,0)
y_out <- simuMSAR(Models[[i]], type="markov")
out2 <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out2$iterations
out2$logLike
out2 <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out2$logLike
out2 <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out2$logLike
out2 <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out2$logLike
out2 <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out2$logLike
out2 <- MSARmdl(y_out$y,1,2,TRUE,TRUE)
out2$logLike
out2$mu
out2$stdev
out2$phi
out2$P
out2 <- MSARmdl(y_out$y,1,2,FALSE,TRUE)
out2$logLike
out2 <- MSARmdl(y_out$y,1,2,FALSE,TRUE)
out2$logLike
out2 <- MSARmdl(y_out$y,1,2,FALSE,TRUE)
out2$logLike
out2$mu
out2$stdev
out2$P
Models[[1]]$n
Models[[1]]$n <-500
y_out <- simuMSAR(Models[[i]], type="markov")
out2 <- MSARmdl(y_out$y,1,2,FALSE,TRUE)
out2$logLike
out2 <- MSARmdl(y_out$y,1,2,FALSE,TRUE)
out2$logLike
out2 <- MSARmdl(y_out$y,1,2,FALSE,TRUE)
out2$logLike
out2$mu
out2$stdev
out2$P
out2 <- MSARmdl(y_out$y,1,2,FALSE,TRUE)
out2$logLike
