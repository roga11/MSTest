% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/models.R
\name{HMmdl}
\alias{HMmdl}
\title{Hidden Markov model}
\usage{
HMmdl(Y, k, control = list())
}
\arguments{
\item{Y}{(Txq) vector with observational data. Required argument.}

\item{k}{integer for the number of regimes to use in estimation. Must be greater than or equal to 2. Default is 2.}

\item{control}{List with optimization options including:}

\item{p}{integer for the number of lags to use in estimation. Must be greater than or equal to 0. Default is 0.}
}
\value{
List with model characteristics
}
\description{
This function estimates a Hidden Markov model
}
\examples{
# Define DGP of MS VAR process
mdl_hmm <- list(n     = 1000, 
                mu    = rbind(c(5,-2),
                              c(10,2)),
                sigma = list(rbind(c(5.0, 1.5),
                                   c(1.5, 1.0)),
                             rbind(c(7.0, 3.0),
                                   c(3.0, 2.0))),
                k     = 2,
                P     = rbind(c(0.98, 0.02),
                              c(0.02, 0.98)))

# Simulate process using simuHMM() function
y_hmm_simu <- simuHMM(mdl_hmm)

# Set options for model estimation
control <- list(msmu   = TRUE, 
                msvar  = TRUE,
                method = "EM",
                use_diff_init = 10)

# Estimate model
y_hmm_mdl <- HMmdl(y_hmm_simu$y, k = 2, control)

y_hmm_mdl

plot(y_hmm_mdl$St[,1], type = 'l')
lines(y_hmm_simu$St, col='red')


# init_mdl <- Nmdl(y_hmm_simu$y, control)
# theta_0 <- initVals_HMmdl(init_mdl,2)
# init_mdl$msmu <- control$msmu
# init_mdl$msvar <- control$msvar
# theta<- theta_0
# 
# 
# out_loglike <- ExpectationM_HMmdl(theta, init_mdl, 2)
# out_max <- EMaximization_HMmdl(theta, init_mdl, out_loglike, 2)
# out_loglike$logLike
# max(abs(out_max$theta - theta))
# theta<-out_max$theta
# 
# out<- HMmdl_em(theta_0, init_mdl, 2, list(maxit=10000, thtol=1e-6))
}
\references{
Hamilton, James D. 1990. “Analysis of time series subject to changes in regime.” Journal of econometrics, 45 (1-2): 39–70

Dempster, A. P., N. M. Laird, and D. B. Rubin. 1977. “Maximum Likelihood from Incomplete Data via the EM Algorithm.” Journal of the Royal Statistical Society. Series B 39 (1): 1–38

Krolzig, Hans-Martin. 1997. “The markov-switching vector autoregressive model.” In Markov-Switching Vector Autoregressions, 6–28. Springer
}
\seealso{
\code{\link{Nmdl}}
}
