% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/models.R
\name{MSARmdl}
\alias{MSARmdl}
\title{Markov-switching autoregressive model}
\usage{
MSARmdl(Y, p, k, control = list())
}
\arguments{
\item{Y}{(Tx1) vector with observational data. Required argument.}

\item{p}{integer for the number of lags to use in estimation. Must be greater than or equal to 0. Default is 0.}

\item{k}{integer for the number of regimes to use in estimation. Must be greater than or equal to 2. Default is 2.}
}
\value{
List with model characteristics
}
\description{
This function estimates a Markov-switching autoregressive model
}
\examples{


# ----------------------- Use GNP growth 1951Q2 - 1984Q4 ----------------------- 
y_gnp_gw_84 <- hamilton84GNP$GNP_logdiff


# Set options for model estimation
control <- list(msmu   = TRUE, 
                msvar  = FALSE, 
                method = "MLE",
                use_diff_init = 10)

# Estimate model with p=4 and switch in mean only as in Hamilton (1989)
hamilton89_mdl <- MSARmdl(as.matrix(y_gnp_gw_84), p = 4, k = 2, control)

hamilton89_mdl

# plot smoothed probability of each state
plot(hamilton89_mdl$St[,1], type = 'l')
plot(hamilton89_mdl$St[,2], type = 'l')

# --------------------------- Use simulated process ----------------------------
# Define DGP of MS AR process
mdl_ms2 <- list(n     = 500, 
                mu    = c(5,10),
                sigma = c(1,2),
                phi   = c(0.5,0.2),
                k     = 2,
                P     = rbind(c(0.90, 0.10),
                              c(0.10, 0.90)))
                              
# Simulate process using simuMSAR() function
y_ms_simu <- simuMSAR(mdl_ms2)

# Set options for model estimation
control <- list(msmu   = TRUE, 
                msvar  = TRUE, 
                method = "EM",
                use_diff_init = 10)

# Estimate model
y_ms_mdl <- MSARmdl(y_ms_simu$y, p = 2, k = 2, control)

y_ms_mdl



}
\references{
Dempster, A. P., N. M. Laird, and D. B. Rubin. 1977. “Maximum Likelihood from Incomplete Data via the EM Algorithm.” Journal of the Royal Statistical Society. Series B 39 (1): 1–38

Hamilton, James D. 1990. “Analysis of time series subject to changes in regime.” Journal of econometrics, 45 (1-2): 39–70
}
\seealso{
\code{\link{ARmdl}}
}
