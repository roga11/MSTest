# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' @title Covariance to correlation matrix
#' 
#' @description This function takes an (n x n) covariance matrix and returns the associated (n x n) correlation matrix
#' 
#' @param (n x n) covariance matrix
#' 
#' @return (n x n) correlation matrix
#' 
#' @export
cov2corr <- function(cov_mat) {
    .Call(`_MSTest_cov2corr`, cov_mat)
}

#' @title Covariance vech function
#' 
#' @description This function returns the half-vectorization of an input matrix as a column vector.
#' 
#' @param mat: (n x n) covariance matrix
#' 
#' @return (n+1)*n/2 column vector 
#' 
#' @export
covar_vech <- function(mat) {
    .Call(`_MSTest_covar_vech`, mat)
}

#' @title Covariance vech to matrix 
#' 
#' @description This function undoes the half-vectorization of a covariance matrix.
#' 
#' @param sig: (n+1)*n/2 vector 
#' n: integer determining shape of the orginal matrix
#' 
#' @return (n x n) covariance matrix
#' 
#' @export
covar_unvech <- function(sig, n) {
    .Call(`_MSTest_covar_unvech`, sig, n)
}

#' @title Random Transition Matrix
#' 
#' @description This function creates a random transition matrix
#' 
#' @param k number of regimes. Must be greater than or equal to 2. 
#' 
#' @return transition matrix with randomly generated entries.
#' 
#' @export
randP <- function(k) {
    .Call(`_MSTest_randP`, k)
}

#' @title Ergodic (limiting) probabilities of states
#' 
#' @description Takes a transition matrix and returns the limiting probabilities
#' 
#' @param P: matrix with transition probabilities
#' 
#' @return (k x 1) vector of limiting probabilities
#' 
#' @export
limP <- function(P) {
    .Call(`_MSTest_limP`, P)
}

#' @title Lagged Time Series Data
#' 
#' @description This function takes a (T x 1) vector Y and returns the (T-p x 1) vector y and the (T-p x p) matrix of lagged observations.
#' 
#' @param Y vector with time series observations. Required argument. 
#' @param ar integer for the number of lags to use in estimation. Must be greater than or equal to 1. Default is 1.
#' 
#' @return List with vector y (vector of lagged Y) and matrix X of lagged observations.
#' 
#' @export
ts_lagged <- function(Y, ar) {
    .Call(`_MSTest_ts_lagged`, Y, ar)
}

#' @title Parameter list for Markov-switching autoregressive model
#' 
#' @description This function takes the parameter vector of interest and converts it to a list with specific parameter vectors needed for univariate Markov-switching functions
#' 
#' @param theta: vector of parameters.
#' @param ar: umber of autoregressive lags
#' @param k: number of regimes
#' @param msmu: bool indicating is the mean switches with regime 
#' @param msvar: bool indicating is the variance switches with regime 
#' 
#' @return List with the mean, variance, transition matrix, limiting probabilities, and a vector of state indicators
#' 
#' @export
paramListMS <- function(theta, ar, k, msmu, msvar) {
    .Call(`_MSTest_paramListMS`, theta, ar, k, msmu, msvar)
}

#' @title Parameter list for Markov-switching vector autoregressive model
#' 
#' @description This function takes the parameter vector of interest and converts it to a list with specific parameter vectors needed for multivariate Markov-switching functions
#' 
#' @param theta: vector of parameters.
#' @param q: number of time series 
#' @param ar: umber of autoregressive lags
#' @param k: number of regimes
#' @param msmu: bool indicating is the mean switches with regime 
#' @param msvar: bool indicating is the variance switches with regime 
#' 
#' @return List with the mean, variance, transition matrix, limiting probabilities, and a vector of state indicators
#' 
#' @export
paramListMSVAR <- function(theta, q, ar, k, msmu, msvar) {
    .Call(`_MSTest_paramListMSVAR`, theta, q, ar, k, msmu, msvar)
}

#' @title Markov-switching autoregressive model residuals
#' 
#' @description This function computes residuals of a Markov-switching autoregressive model
#' 
#' @param mdl List containing relevant parameters.
#' @param mu vector with mean in each regime.
#' @param k number of regimes. Must be greater than or equal to 2. 
#' 
#' @return (TxM) matrix of residuals in each regime M where M=k^(ar+1)
#' 
#' @export
calcMSResid <- function(mdl, mu, k) {
    .Call(`_MSTest_calcMSResid`, mdl, mu, k)
}

#' @title Markov-switching vector autoregressive model residuals
#' 
#' @description This function computes residuals of a Markov-switching vector autoregressive model. Note that 
#' 
#' @param mdl List containing relevant parameters.
#' @param mu vector with mean in each regime.
#' @param k number of regimes. Must be greater than or equal to 2. 
#' 
#' @return List with M (Txq) matrix of residuals in each regime M where M=k^(ar+1)
#' 
#' @export
calcMSVARResid <- function(mdl, mu, k) {
    .Call(`_MSTest_calcMSVARResid`, mdl, mu, k)
}

#' @title Initial values for Markov-switching autoregressive model
#' 
#' @description This function generates a random parameter vector to be used as initial values for a Markov-switching autoregressive model
#' 
#' @param mdl: List with parameter values of simple (one-regime) autoregressive model. This includes
#'   - phi: vector autoregressive coefficients
#'   - mu: mean of process 
#'   - stdev: standard deviation
#'   - msmu: boolean indicator. If TRUE, mean is function of markov process. If FALSE, mean is constant across regimes
#'   - msvar: boolean indicator. If TRUE, standard deviation is function of markov process. If FALSE, standard deviation is constant across regimes
#' @param k: number of regimes
#' 
#' @return vector of initial parameter values
#' 
#' @export
initValsMS <- function(mdl, k) {
    .Call(`_MSTest_initValsMS`, mdl, k)
}

#' @title Initial values for Markov-switching vector autoregressive model
#' 
#' @description This function generates a random parameter vector to be used as initial values for a Markov-switching vector autoregressive model
#' 
#' @param mdl: List with parameter values of simple (one-regime) vector autoregressive model. This includes
#'   - phi: matrix autoregressive coefficients
#'   - mu: vector of means
#'   - sigma: covariance matrix
#'   - msmu: boolean indicator. If TRUE, mean is function of markov process. If FALSE, mean is constant across regimes
#'   - msvar: boolean indicator. If TRUE, standard deviation is function of markov process. If FALSE, standard deviation is constant across regimes
#' @param k: number of regimes
#' 
#' @return vector of initial parameter values
#' 
#' @export
initValsMSVAR <- function(mdl, k) {
    .Call(`_MSTest_initValsMSVAR`, mdl, k)
}

#' @title Monte Carlo P-value
#' 
#' @description This function computes the Monte Carlo P-value
#' 
#' @param test_stat: test statistic under the alternative (e.g. S_0)
#' @param null_vec: (N x 1) vector with test statistic under the null hypothesis
#' @param type: type of test of test. options are: "geq" for right-tail test, "leq" for 
#' left-tail test, "abs" for absolute vallue test and "two-tail" for two-tail test.
#' 
#' @return MC p-value of test
#' 
#' @references Dufour, J. M. (2006). Monte Carlo tests with nuisance parameters: 
#' A general approach to finite-sample inference and nonstandard asymptotics. 
#' Journal of Econometrics, 133(2), 443-477.
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
MCpval <- function(test_stat, null_vec, type = "geq") {
    .Call(`_MSTest_MCpval`, test_stat, null_vec, type)
}

#' @title Simulate autoregressive process
#' 
#' @description This function simulates an autoregresive process
#' 
#' @param mdl_h0: List containing the following DGP parameters
#'   - n: length of series
#'   - mu: mean of process 
#'   - sigma: standard deviation of process
#'   - phi: vector of autoregressive coefficients
#'   
#' @param burnin: number of simulated observations to remove from beginning. Default is 100
#' 
#' @return List with simulated autoregressive series and its DGP parameters
#' 
#' @export
simuAR <- function(mdl_h0, burnin = 100L) {
    .Call(`_MSTest_simuAR`, mdl_h0, burnin)
}

#' @title Simulate Markov-switching autoregressive process
#' 
#' @description This function simulates a Markov-switching autoregressive process
#' 
#' @param mdl_h0: List containing the following DGP parameters
#'   - n: length of series
#'   - k: number of regimes
#'   - mu: (k x 1) vector with mean of process in each regime
#'   - sigma: (k x 1) vector with standard deviation of process in each regime
#'   - phi: vector of autoregressive coefficients
#'   - P: (k x k) transition matrix (columns must sum to one)
#'   
#' @param burnin: number of simulated observations to remove from beginning. Default is 100
#' 
#' @return List with simulated Markov-switching autoregressive process and its DGP properties
#' 
#' @export
simuMSAR <- function(mdl_h0, burnin = 100L) {
    .Call(`_MSTest_simuMSAR`, mdl_h0, burnin)
}

#' @title Simulate VAR process
#' 
#' @description This function simulates a vector autoregresive process
#' 
#' @param mdl_h0: List containing the following DGP parameters
#'   - n: length of series
#'   - mu: (q x 1) vector of means 
#'   - sigma: (q x q) covariance matrix 
#'   - phi: (q x qp) matrix of autoregressive coefficients
#'   - ar: number of autoregressive lags (i.e, p)
#'   
#' @param burnin: number of simulated observations to remove from beginning. Default is 100
#' 
#' @return List with simulated vector autoregressive series and its DGP parameters
#' 
#' @export
simuVAR <- function(mdl_h0, burnin = 100L) {
    .Call(`_MSTest_simuVAR`, mdl_h0, burnin)
}

#' @title Simulate Markov-switching vector autoregressive process
#' 
#' @description This function simulates a Markov-switching vector autoregressive process
#' 
#' @param mdl_h0: List containing the following DGP parameters
#'   - n: length of series
#'   - k: number of regimes
#'   - mu: (k x q) matrix of means 
#'   - sigma: List with k (q x q) covariance matrices
#'   - phi: (q x qp) matrix of autoregressive coefficients
#'   - ar: number of autoregressive lags (i.e, p)
#'   - P: (k x k) transition matrix (columns must sum to one)
#'   
#' @param burnin: number of simulated observations to remove from beginning. Default is 100
#' 
#' @return List with simulated vector autoregressive series and its DGP parameters
#' 
#' @export
simuMSVAR <- function(mdl_h0, burnin = 100L) {
    .Call(`_MSTest_simuMSVAR`, mdl_h0, burnin)
}

#' @title Simulate normally distributed process
#' 
#' @description This function simulates a normally distributed process
#' 
#' @param mdl_h0: List containing the following DGP parameters
#'   - n: length of series
#'   - mu: (q x 1) vector of means 
#'   - sigma: (q x q) covariance matrix. If simulating a univariate process (i.e., length of mu is 1), this should be the standard devation and not the variance.
#'   
#' @return List with simulated series and its DGP parameters
#' 
#' @export
simuNorm <- function(mdl_h0) {
    .Call(`_MSTest_simuNorm`, mdl_h0)
}

#' @title Simulate Hidden Markov model with normally distributed errors
#' 
#' @description This function simulates a Hidden Markov Model process
#' 
#' @param mdl_h0: List containing the following DGP parameters
#'   - n: length of series
#'   - k: number of regimes
#'   - mu: (k x q) vector of means 
#'   - sigma: (q x q) covariance matrix. If simulating a univariate process (i.e., length of mu is 1), this should be the standard devation and not the variance.
#'   - P: (k x k) transition matrix (columns must sum to one)
#'   
#' @param burnin: number of simulated observations to remove from beginning. Default is 100
#' 
#' @return List with simulated series and its DGP parameters
#' 
#' @export
simuHMM <- function(mdl_h0, burnin = 100L) {
    .Call(`_MSTest_simuHMM`, mdl_h0, burnin)
}

#' @title Calc eq. 2.5 from CHP (2014) where both mean and variance can switch
#'
#' @description When alternative has bith switching mean and variance, we take the second 
#' derivative of the log likelihood function w.r.t mu, phi and sigma.
#' 
#' Output from this function is used as input in \emph{chpStat}
#'
#' @param mdl List containing model information
#' @param rho_b bound for rho (nuisance param space)
#' @param ltmt List conatining derivatives (i.e. is the output when using \emph{chpDmat})
#' 
#' @return mu_2t from eq. 2.5 and used in test-statistic caluclation
#' 
#' @references Carrasco, Marine, Liang Hu, and Werner Ploberger. 2014. 
#' “Optimal test for Markov switch- ing parameters.” \emph{Econometrica} \bold{82 (2)}: 765–784.
#' 
#' @export
calc_mu2t_mv <- function(mdl, rho, ltmt, hv) {
    .Call(`_MSTest_calc_mu2t_mv`, mdl, rho, ltmt, hv)
}

#' @title Calc eq. 2.5 from CHP (2014) where only mean can switch
#'
#' @description When alternative only has Switching mean (and not variance), we only take the second 
#' derivative of the log likelihood function w.r.t mu and not phi or sigma.
#' 
#' Output from this function is used as input in \emph{chpStat}
#'
#' @param mdl List containing model information
#' @param rho_b bound for rho (nuisance param space)
#' @param ltmt List conatining derivatives (i.e. is the output when using \emph{chpDmat})
#' 
#' @return mu_2t from eq. 2.5 and used in test-statistic caluclation
#' 
#' @references Carrasco, Marine, Liang Hu, and Werner Ploberger. 2014. 
#' “Optimal test for Markov switch- ing parameters.” \emph{Econometrica} \bold{82 (2)}: 765–784.
#' @export
calc_mu2t <- function(mdl, rho, ltmt) {
    .Call(`_MSTest_calc_mu2t`, mdl, rho, ltmt)
}

#' @title CHP Test Statistic
#' 
#' @description Calculate supTS and expTS test-statistics from CHP (2014).
#'
#' @param mdl List containing model information
#' @param rho_b bound for rho (nuisance param space)
#' @param ltmt List containing  relevant first and second derivatives of log likelihood function.
#' @param var_switch variance switch indicator
#' 
#' @return Test Statistic
#' 
#' @references Carrasco, Marine, Liang Hu, and Werner Ploberger. 2014. 
#' “Optimal test for Markov switch- ing parameters.” \emph{Econometrica} \bold{82 (2)}: 765–784.
#' 
#' @export
chpStat <- function(mdl, rho_b, ltmt, var_switch) {
    .Call(`_MSTest_chpStat`, mdl, rho_b, ltmt, var_switch)
}

#' @title Bootstrap Critival Values CHP Test
#'
#' @description This bootstrap procedure is described on page 771 of CHP (2014)
#'
#' @param mdl List containing model information
#' @param rho_b bound for rho (nuisance param space)
#' @param N number of simulations
#' @param var_switch variance switch indicator
#' 
#' @return Bootstrap critical values
#' 
#' @references Carrasco, Marine, Liang Hu, and Werner Ploberger. 2014. 
#' “Optimal test for Markov switch- ing parameters.” \emph{Econometrica} \bold{82 (2)}: 765–784.
#' 
#' @export
bootCV <- function(mdl, rho_b, N, var_switch) {
    .Call(`_MSTest_bootCV`, mdl, rho_b, N, var_switch)
}

#' @title Likelihood Ratio Test Statistic Sample Distribution
#' 
#' 
#' @export
LR_samp_dist <- function(mdl_h0, k1, msmu, msvar, N, maxit, thtol, burnin, max_init, dist_converge_iter, init_val_try_dist) {
    .Call(`_MSTest_LR_samp_dist`, mdl_h0, k1, msmu, msvar, N, maxit, thtol, burnin, max_init, dist_converge_iter, init_val_try_dist)
}

#' @title Monte Carlo Likelihood Ratio Test P-value Function 
#' 
#' 
#' @export
MMCLRpval_fun <- function(theta, mdl_h0, mdl_h1, msmu, msvar, ar, N, maxit, thtol, burnin, stationary_ind, lambda, max_init, dist_converge_iter, init_val_try_dist, workers) {
    .Call(`_MSTest_MMCLRpval_fun`, theta, mdl_h0, mdl_h1, msmu, msvar, ar, N, maxit, thtol, burnin, stationary_ind, lambda, max_init, dist_converge_iter, init_val_try_dist, workers)
}

#' @title Monte Carlo Likelihood Ratio Test P-value Function 
#' 
#' 
#' @export
MMCLRpval_fun_max <- function(theta, mdl_h0, mdl_h1, msmu, msvar, ar, N, maxit, thtol, burnin, stationary_ind, lambda, max_init, dist_converge_iter, init_val_try_dist, workers) {
    .Call(`_MSTest_MMCLRpval_fun_max`, theta, mdl_h0, mdl_h1, msmu, msvar, ar, N, maxit, thtol, burnin, stationary_ind, lambda, max_init, dist_converge_iter, init_val_try_dist, workers)
}

#' @title Calculate Dufour & Luger (2017) Moment-Based Test-Statistics 
#'
#' @description This function computes the four momment-based test-statistics (eq. 11 - 14 in paper) 
#' for a given series. The series should be the residuals from an AR model. 
#' 
#'
#' @param ehat vector containing series of residuals from model.
#' 
#' @return The four test statistics (eq. 11 - 14 in paper)
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
calc_DLmoments <- function(ehat) {
    .Call(`_MSTest_calc_DLmoments`, ehat)
}

#' @title Test-statistics from simulated data
#'
#' @description This function computes simulates residuals from a standard normal distribution
#' and calculates the four momment-based test-statistics (eq. 11 - 14 in paper) under the 
#' null hypothesis using this simulated data.
#' 
#' @param t length of sample size for simulation 
#' @param number of simulated samples
#' 
#' @return The four test statistics (eq. 11 - 14 in paper)
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
sim_DLmoments <- function(Tsize, N) {
    .Call(`_MSTest_sim_DLmoments`, Tsize, N)
}

#' @title Combine p-values 
#'
#' @description This function is used to combine the p-values as in eq 17 and 18 of Dufour & Luger (2017).
#' The input parameter \emph{type} can be used to used to specify the method for combining 
#' the pvalues. If set to "min" the min method of combining p-values is used as in Fisher (1932) 
#' and Pearson (1933). If set to "prod" the product of p-values is used as in Tippett (1931) 
#' and Wilkinson (1951).
#' 
#' @param s0 test-statistic under the alternative
#' @param sN test-statistics under the null
#' @param param output from \emph{approxDist} which obtains the parameters needed in eq. 16 which is used for 
#' combining p-values.
#' @param N total number of test statistics (i.e. simulated + observed = N)
#' @param type the type of method used to combine p-values. If set to "min" the min method of combining p-values is used as in Fisher (1932) 
#' and Pearson (1933). If set to "prod" the product of p-values is used as in Tippett (1931) 
#' and Wilkinson (1951).
#' 
#' @return The four test statistics (eq. 11 - 14 in paper)
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' @references Tippett, L. (1931). The Method of Statistics. London: Williams & Norgate.
#' @references Wilkinson, B. (1951). A statistical consideration in psychological research. 
#' Psychology Bulletin 48:156–158.
#' @references Pearson, K. (1933). On a method of determining whether a sample of size n
#'  supposed to have been drawn from a parent population having a known probability integral has probably been drawn at random. Biometrika 25:379–410.
#' @references Fisher, R. (1932). Statistical Methods for Research Workers. Edinburgh: 
#' Oliver and Boyd.
#' 
#' @export
combine_stat <- function(s0, sN, params, type) {
    .Call(`_MSTest_combine_stat`, s0, sN, params, type)
}

#' @title Calculate combined p-value test statistic 
#'
#' @description This function computes test-statistics for observed and simulated samples. 
#' It begins by calculating it for the obsted data, then generates test-statistics from 
#' simulated data to approximate null distribution and then calculates the p-values and 
#' combines them according to eq. 17 or 18 of Dufour & Luger (2017).
#' 
#' @param ezt observed series
#' @param N total number of test statistics (i.e. simulated + observed = N)
#' @param param output from \emph{approxDist} which obtains the parameters needed in eq. 16 which is used for 
#' combining p-values.
#' 
#' @return The four test statistics (eq. 11 - 14 in paper)
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
calc_DLmcstat <- function(ezt, N, params, type = "min") {
    .Call(`_MSTest_calc_DLmcstat`, ezt, N, params, type)
}

#' @title Loop for \emph{approxDist}
#'
#' @description This function performs the loop in \emph{approxDist}. It is written in C++ for better 
#' performance in terms of speed.
#' 
#' @param SN2 matrix of Tx4 test-statistics
#' 
#' @return The four test statistics from smulated data in [0,1]. Used for NLS to get 
#' params needed to combine p-values
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export    
approx_dist_loop <- function(SN2) {
    .Call(`_MSTest_approx_dist_loop`, SN2)
}

#' @title Dufour & Luger (2017) moment-based MMC test p-value function to be minimized
#'
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
DLMMCpval_fun <- function(theta, y, x, N, simdist_N, pval_type, stationary_ind, lambda) {
    .Call(`_MSTest_DLMMCpval_fun`, theta, y, x, N, simdist_N, pval_type, stationary_ind, lambda)
}

#' @title Dufour & Luger (2017) moment-based MMC test p-value function to be maximized
#'
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
DLMMCpval_fun_max <- function(theta, y, x, N, simdist_N, pval_type, stationary_ind, lambda) {
    .Call(`_MSTest_DLMMCpval_fun_max`, theta, y, x, N, simdist_N, pval_type, stationary_ind, lambda)
}

#' @title Autoregressive log-likelihood objective function
#' 
#' @description This function computes the log-likelihood for an autoregressive model
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' 
#' @return log-likelihood given data
#' 
#' @export
AR_loglik_fun <- function(theta, mdl) {
    .Call(`_MSTest_AR_loglik_fun`, theta, mdl)
}

#' @title Autoregressive Model
#' 
#' @description This function estimates an autoregresive model
#' 
#' @param Y vector of observations
#' @param ar number of lags
#' @param intercept boolean indicator determining whether or not to include constant. Default is TRUE.
#' @param getSE boolean indicator determining whether or not to estimate standard errors
#' 
#' @return List with model attributes which include
#' - y: transformed process
#' - X: matrix of lagged observations (with or without vector of 1s depending on const=1 or const=0)
#' - x: matrix of lagged observations without vector of 1s
#' - n: number of observations (T-ar)
#' - ar: number of autoregressive parameters
#' - coef: coefficient estimates. This is the same as phi is const=0
#' - phi: autoregressive coefficient estimates
#' - mu: the mean of the process
#' - residuals: vectot of residuals
#' - stdev: standard deviations
#' - se: standard errors of parameter estimtes
#' - logLike: the log-likelihood 
#' 
#' @export
ARmdl <- function(Y, ar, intercept = 1L, getSE = 0L) {
    .Call(`_MSTest_ARmdl`, Y, ar, intercept, getSE)
}

#' @title Vector autoregressive log-likelihood objective function 
#' 
#' @description This function computes the log-likelihood for a vector autoregressive model
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' 
#' @return log-likelihood given data
#' 
#' @export
VAR_loglik_fun <- function(theta, mdl) {
    .Call(`_MSTest_VAR_loglik_fun`, theta, mdl)
}

#' @title Vector autoregressive model
#' 
#' @description This function estimates a vector autoregresive model
#' 
#' @param Y is a (T x q) matrix of observations
#' @param ar number of lags
#' @param intercept boolean indicator determining whether or not to include constant. Default is TRUE.
#' @param getSE boolean indicator determining whether or not to estimate standard errors
#' 
#' @return List with model attributes
#' 
#' @export
VARmdl <- function(Y, ar, intercept = 1L, getSE = 0L) {
    .Call(`_MSTest_VARmdl`, Y, ar, intercept, getSE)
}

#' @title Markov-switching autoregressive log-likelihood objective function
#' 
#' @description This function computes the log-likelihood for a markov-switching autoregressive model
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' @param k integer determining the number of regimes
#' 
#' @return log-likelihood given data
#' 
#' @export
MSloglik_fun <- function(theta, mdl, k) {
    .Call(`_MSTest_MSloglik_fun`, theta, mdl, k)
}

#' @title Markov-switching autoregressive log-likelihood objective function (minimization version)
#' 
#' @description This function computes the (negative) log-likelihood for a markov-switching autoregressive model
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' @param k integer determining the number of regimes
#' 
#' @return negative log-likelihood given data
#' 
#' @export
MSloglik_fun_min <- function(theta, mdl, k) {
    .Call(`_MSTest_MSloglik_fun_min`, theta, mdl, k)
}

#' @title Markov-switching autoregressive log-likelihood function 
#' 
#' @description This function computes the log-likelihood for a markov-switching autoregressive model and uses the Hamilton smoother to obtain smoothed probabilities of each state. This is also the expectation step in the Expectation Maximization algorithm for a Markov-switching autoregressive model.
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' @param k integer determining the number of regimes
#' 
#' @return log-likelihood given data
#'  
#' @return List with log-likelihood (log-likelihood), and smoothed probabilities of each regime (xi_t_T).
#' 
#' @export
MSloglik <- function(theta, mdl, k) {
    .Call(`_MSTest_MSloglik`, theta, mdl, k)
}

#' @title Markov-switching vector autoregressive log-likelihood objective function
#' 
#' @description This function computes the log-likelihood for a markov-switching vector autoregressive model
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' @param k integer determining the number of regimes
#' 
#' @return log-likelihood given data
#' 
#' @export
MSVARloglik_fun <- function(theta, mdl, k) {
    .Call(`_MSTest_MSVARloglik_fun`, theta, mdl, k)
}

#' @title Markov-switching vector autoregressive log-likelihood objective function (minimization version)
#' 
#' @description This function computes the (negative) log-likelihood for a markov-switching vector autoregressive model
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' @param k integer determining the number of regimes
#' 
#' @return negative log-likelihood given data
#' 
#' @export
MSVARloglik_fun_min <- function(theta, mdl, k) {
    .Call(`_MSTest_MSVARloglik_fun_min`, theta, mdl, k)
}

#' @title Markov-switching vector autoregressive log-likelihood function
#' 
#' @description This function computes the log-likelihood for a markov-switching vector autoregressive model and uses the Hamilton smoother to obtain smoothed probabilities of each state. This is also the expectation step in the Expectation Maximization algorithm for a Markov-switching autoregressive model.
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' @param k integer determining the number of regimes
#' 
#' @return log-likelihood given data
#'  
#' @return List with log-likelihood (log-likelihood), and smoothed probabilities of each regime (xi_t_T).
#' 
#' @export
MSVARloglik <- function(theta, mdl, k) {
    .Call(`_MSTest_MSVARloglik`, theta, mdl, k)
}

#' @title Maximization step of EM algorithm for Markov-switching autoregressive model
#' 
#' @description This function performs the maximization step of the Expectation Maximization algorithm for Markov-switching autoregressive model.
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' @param MSloglik_output List with output from Expectation step of EM algorithm for Markov-switching autoregressive model
#' @param k integer determining the number of regimes
#' 
#' @return List with new maximized parameters
#' 
#' @export
MS_EMaximization <- function(theta, mdl, MSloglik_output, k) {
    .Call(`_MSTest_MS_EMaximization`, theta, mdl, MSloglik_output, k)
}

#' @title Maximization step of EM algorithm for Markov-switching vector autoregressive model
#' 
#' @description This function performs the maximization step of the Expectation Maximization algorithm for Markov-switching vector autoregressive model.
#' 
#' @param theta vector of model parameters
#' @param mdl List with model attributes
#' @param MSloglik_output List with output from Expectation step of EM algorithm for Markov-switching vector autoregressive model
#' @param k integer determining the number of regimes
#'  
#' @return List with new maximized parameters
#' 
#' @export
MSVAR_EMaximization <- function(theta, mdl, MSloglik_output, k) {
    .Call(`_MSTest_MSVAR_EMaximization`, theta, mdl, MSloglik_output, k)
}

#' @title EM algorithm iteration for Markov-switching autoregressive model
#' 
#' @description This function performs the one iteration (E-step and M-step) of the Expectation Maximization algorithm for Markov-switching autoregressive model.
#' 
#' @param mdl List with model attributes
#' @param EMest_output List with attributes from previous iteration
#' @param k integer determining the number of regimes
#' 
#' @return List with attributes from new iteration
#' 
#' @export
MS_EMiter <- function(mdl, EMest_output, k) {
    .Call(`_MSTest_MS_EMiter`, mdl, EMest_output, k)
}

#' @title EM algorithm iteration for Markov-switching vector autoregressive model
#' 
#' @description This function performs the one iteration (E-step and M-step) of the Expectation Maximization algorithm for Markov-switching vector autoregressive model.
#' 
#' @param mdl List with model attributes
#' @param EMest_output List with attributes from previous iteration
#' @param k integer determining the number of regimes
#' 
#' @return List with attributes from new iteration
#' @export
MSVAR_EMiter <- function(mdl, EMest_output, k) {
    .Call(`_MSTest_MSVAR_EMiter`, mdl, EMest_output, k)
}

#' @title Estimation of Markov-switching autoregressive model by EM Algorithm 
#' 
#' @description Estimate Markov-switching autoregressive model by EM algorithm. This function is used by MSmdl_EM() which organizes the output and takes raw data as input.
#' 
#' @param theta_0 vector with initital values for parameters
#' @param mdl List with model attributes
#' @param k integer determining the number of regimes
#' @param optim_options List with optimiztion options
#' 
#' @return List with model results
#' 
#' @export
MS_EMest <- function(theta_0, mdl, k, optim_options) {
    .Call(`_MSTest_MS_EMest`, theta_0, mdl, k, optim_options)
}

#' @title Estimation of Markov-switching vector autoregressive model by EM Algorithm 
#' 
#' @description Estimate Markov-switching vector  autoregressive model by EM algorithm. This function is used by MSmdl_EM() which organizes the output and takes raw data as input.
#' 
#' @param theta_0 vector with initital values for parameters
#' @param mdl List with model attributes
#' @param k integer determining the number of regimes
#' @param optim_options List with optimiztion options
#' 
#' @return List with model results
#' 
#' @export
MSVAR_EMest <- function(theta_0, mdl, k, optim_options) {
    .Call(`_MSTest_MSVAR_EMest`, theta_0, mdl, k, optim_options)
}

