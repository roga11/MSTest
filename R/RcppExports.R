# Generated by using Rcpp::compileAttributes() -> do not edit by hand
# Generator token: 10BE3573-1514-4C36-9D1C-5A225CD40393

#' @title Sum of only finite values of columns of a matrix (of vector)
#' 
#' @description 
#' 
#' 
#' @return 
#' 
#' @export
sumfinite <- function(x, ncol = 1L) {
    .Call(`_MSTest_sumfinite`, x, ncol)
}

#' @title returns finite components of matrix
#' 
#' @description 
#' 
#' 
#' @return 
#' 
#' @export
finitemat <- function(x) {
    .Call(`_MSTest_finitemat`, x)
}

#' @title musigGrid cpp version (TESTING FOR SPEED - SLOWER)
#' 
#' 
#' @export
musigGrid_cpp <- function(mu, sig, k, ar) {
    .Call(`_MSTest_musigGrid_cpp`, mu, sig, k, ar)
}

#' @title Limiting Probabilities of States
#' 
#' @description Takes a transition matrix and returns the limiting probabilities
#' 
#' @param P matrix with transition probabilities
#' 
#' @return Vector of Limiting probabilities of a transition matrix
#' 
#' @export
limP <- function(P, k) {
    .Call(`_MSTest_limP`, P, k)
}

#' @title Parameter List
#' 
#' @description This function takes the vector of parameters of interest and converts it to a list with the parameters seperated
#' 
#' @param theta vector of parameters.
#' @param mdl List of model properties
#' @param k number of regimes. Must be greater than or equal to 2. 
#' @param msmu bool indicating is the mean switches with regime 
#' @param msvar bool indicating is the variance switches with regime 
#' 
#' @return List with the mean, variance, transition matrix and limiting probabilities
#' 
#' @export
paramList <- function(theta, ar, k, msmu, msvar) {
    .Call(`_MSTest_paramList`, theta, ar, k, msmu, msvar)
}

#' @title Parameter List
#' 
#' @description This function takes the vector of parameters of interest and converts it to a list with the parameters seperated
#' 
#' @param theta vector of parameters.
#' @param mdl List of model properties
#' @param k number of regimes. Must be greater than or equal to 2. 
#' @param msmu bool indicating is the mean switches with regime 
#' @param msvar bool indicating is the variance switches with regime 
#' 
#' @return List with the mean, variance, transition matrix and limiting probabilities
#' 
#' @export
VARparamList <- function(theta, N, ar, k, msmu, msvar) {
    .Call(`_MSTest_VARparamList`, theta, N, ar, k, msmu, msvar)
}

#' @title Calculate Residuals for Markov-switching model
#' 
#' @description This function computes residuals when mean or conditional mean 
#' (i.e. when dealing with AR model) switches with regime.
#' 
#' @param mdl List containing relevant parameters.
#' @param mu vector with mean in each regime.
#' @param k number of regimes. Must be greater than or equal to 2. 
#' @param ar bool indicator for whether model is AR model.
#'  
#' 
#' @return (Txk) matrix of residuals in each regime.
#' 
#' @export
calcMSResid <- function(mdl, mu, k) {
    .Call(`_MSTest_calcMSResid`, mdl, mu, k)
}

#' @title Calculate Residuals for Markov-switching VAR model
#' 
#' @description This function computes residuals when mean or conditional mean 
#' (i.e. when dealing with AR model) switches with regime.
#' 
#' @param mdl List containing relevant parameters.
#' @param mu vector with mean in each regime.
#' @param k number of regimes. Must be greater than or equal to 2. 
#' @param ar bool indicator for whether model is AR model.
#'  
#' 
#' @return (Txk) matrix of residuals in each regime.
#' 
#' @export
calcMSVARResid <- function(mdl, mu, k) {
    .Call(`_MSTest_calcMSVARResid`, mdl, mu, k)
}

#' @title Lagged Time Series Data
#' 
#' @description This function takes a (Tx1) vector Y and returns the (T-px1) vector y and matrix of lagged observations.
#' 
#' @param Y vector with time series observations. Required argument. 
#' @param ar integer for the number of lags to use in estimation. Must be greater than or equal to 1. Default is 1.
#' 
#' @return List with vector y (vector of lagged Y) and matrix X of lagged observations.
#' 
#' @export
ts_lagged <- function(Y, ar) {
    .Call(`_MSTest_ts_lagged`, Y, ar)
}

#' @title Random Transition Matrix
#' 
#' @description This function creates a (kxk) random transition matrix
#' 
#' @param k number of regimes. Must be greater than or equal to 2. 
#' @param n number of random sample to use. By default it is 100 but this can be set to length of TS for example
#'  
#' 
#' @return transition matrix with randomly generated entries.
#' 
#' @export
randTransMat <- function(k) {
    .Call(`_MSTest_randTransMat`, k)
}

#' @title generate initial values for EM Algorithm 
#' 
#' 
#' @export
initVals <- function(mdl, k, msmu, msvar) {
    .Call(`_MSTest_initVals`, mdl, k, msmu, msvar)
}

#' @title generate initial values for EM Algorithm 
#' 
#' 
#' @export
initValsVAR <- function(mu, sigma, k, msmu, msvar) {
    .Call(`_MSTest_initValsVAR`, mu, sigma, k, msmu, msvar)
}

#' @title generate initial values for EM Algorithm using Kmeans algorithm 
#' 
#' 
#' @export
initValsKM <- function(Y, k, msmu, msvar) {
    .Call(`_MSTest_initValsKM`, Y, k, msmu, msvar)
}

#' @title Calculate MC P-Value
#' 
#' @description This function calculates a Monte-Carlo p-value
#' 
#' @param test_stat test statistic under the alternative (e.g. S_0)
#' @param null_vec series with test statistic under the null (i.e. vector S)
#' @param type like of test. options are: "geq" for right-tail test, "leq" for 
#' left-tail test, "abs" for absolute vallue test and "two-tail" for two-tail test.
#' 
#' @return MC p-value of test
#' 
#' @references Dufour, J. M. (2006). Monte Carlo tests with nuisance parameters: 
#' A general approach to finite-sample inference and nonstandard asymptotics. 
#' Journal of Econometrics, 133(2), 443-477.
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
MCpval <- function(test_stat, null_vec, type = "geq") {
    .Call(`_MSTest_MCpval`, test_stat, null_vec, type)
}

#' @title Simulate Autoregressive Series
#' 
#' @description This function simulates an autoregresive series
#' 
#' @param mdl_h0 List containing series properties such as n: length, ar: number of autoregressive lags, stdev: standard deviation, mu: mean of process, phi: vector of autoregressive coefficients
#' @param burnin number of simulated observations to remove from begining. If using mu not equal to 0 it is recommended to use burnin to avoid dependence on initial value. Default is 200.
#' 
#' @return List with autoregressive series and its properties
#' 
#' @export
simuAR <- function(mdl_h0, burnin = 200L) {
    .Call(`_MSTest_simuAR`, mdl_h0, burnin)
}

#' @title Simulate Markov-switching Autoregressive Series
#' 
#' @description This function simulates a Markov-switching autoregressive series
#' 
#' @param mdl_h0 List containing series properties such as n: length, ar: number of autoregressive lags, 
#' stdev: standard deviation, mu: mean of process, phi: vector of autoregressive coefficients, P: transition matrix (if type="markov")
#' or vector of component weights (if type="mixture"), k: number of regimes.
#' @param type determines type of St is a Markov process or a random mixture. Default is "markov" 
#' @param burnin number of simulated observations to remove from beginning. By assumption, series begins in state 1 
#' so it is recommended to use burnin to avoid dependence on this assumption. Default is 200.
#' 
#' @return List with Markov-switching autoregressive series and its properties
#' 
#' @export
simuMSAR <- function(mdl_h0, type = "markov", burnin = 200L) {
    .Call(`_MSTest_simuMSAR`, mdl_h0, type, burnin)
}

#' @title Simulate Markov-switching  Series
#' 
#' @description This function simulates a Markov-switching  series
#' 
#' @param mdl_h0 List containing series properties such as n: length, ar: number of autoregressive lags, 
#' stdev: standard deviation, mu: mean of process, phi: vector of autoregressive coefficients, P: transition matrix (if type="markov")
#' or vector of component weights (if type="mixture"), k: number of regimes.
#' @param type determines type of St is a Markov process or a random mixture. Default is "markov" 
#' @param burnin number of simulated observations to remove from beginning. By assumption, series begins in state 1 
#' so it is recommended to use burnin to avoid dependence on this assumption. Default is 200.
#' 
#' @return List with Markov-switching series and its properties
#' 
#' @export
simuMS <- function(mdl_h0, type = "markov", burnin = 200L) {
    .Call(`_MSTest_simuMS`, mdl_h0, type, burnin)
}

#' @title convert covariance matrix to correlation matrix
#' 
#' 
#' @export
cov2corr <- function(cov_mat) {
    .Call(`_MSTest_cov2corr`, cov_mat)
}

#' @title Simulate VAR Model
#' 
#' 
#' @export
simuVAR <- function(mdl_h0, burnin = 200L) {
    .Call(`_MSTest_simuVAR`, mdl_h0, burnin)
}

#' @title Simulate Markov-Switching VAR Model
#' 
#' 
#' @export
simuMSVAR <- function(mdl_h0, type = "markov", burnin = 200L) {
    .Call(`_MSTest_simuMSVAR`, mdl_h0, type, burnin)
}

#' @title Likelihood Ratio Test Statistic Sample Distribution
#' 
#' 
#' @export
LR_samp_dist <- function(mdl_h0, k1, msmu, msvar, N, maxit, thtol, burnin, max_init, dist_converge_iter, init_val_try_dist) {
    .Call(`_MSTest_LR_samp_dist`, mdl_h0, k1, msmu, msvar, N, maxit, thtol, burnin, max_init, dist_converge_iter, init_val_try_dist)
}

#' @title Monte Carlo Likelihood Ratio Test P-value Function 
#' 
#' 
#' @export
MMCLRpval_fun <- function(theta, mdl_h0, mdl_h1, msmu, msvar, ar, N, maxit, thtol, burnin, stationary_ind, lambda, max_init, dist_converge_iter, init_val_try_dist) {
    .Call(`_MSTest_MMCLRpval_fun`, theta, mdl_h0, mdl_h1, msmu, msvar, ar, N, maxit, thtol, burnin, stationary_ind, lambda, max_init, dist_converge_iter, init_val_try_dist)
}

#' @title Monte Carlo Likelihood Ratio Test P-value Function 
#' 
#' 
#' @export
MMCLRpval_fun_max <- function(theta, mdl_h0, mdl_h1, msmu, msvar, ar, N, maxit, thtol, burnin, stationary_ind, lambda, max_init, dist_converge_iter, init_val_try_dist) {
    .Call(`_MSTest_MMCLRpval_fun_max`, theta, mdl_h0, mdl_h1, msmu, msvar, ar, N, maxit, thtol, burnin, stationary_ind, lambda, max_init, dist_converge_iter, init_val_try_dist)
}

#' @title Calculate Dufour & Luger (2017) Moment-Based Test-Statistics 
#'
#' @description This function computes the four momment-based test-statistics (eq. 11 - 14 in paper) 
#' for a given series. The series should be the residuals from an AR model. 
#' 
#'
#' @param ehat vector containing series of residuals from model.
#' 
#' @return The four test statistics (eq. 11 - 14 in paper)
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
calc_DLmoments <- function(ehat) {
    .Call(`_MSTest_calc_DLmoments`, ehat)
}

#' @title Calculate Quantile Moment-Based Test-Statistics 
#'
#' @description This function computes the four momment-based test-statistics (eq. 11 - 14 in paper) 
#' for a given series. The series should be the residuals from an AR model. 
#' 
#' @export
calc_Qmoments <- function(eps, k1) {
    .Call(`_MSTest_calc_Qmoments`, eps, k1)
}

#' @title Test-statistics from simulated data
#'
#' @description This function computes simulates residuals from a standard normal distribution
#' and calculates the four momment-based test-statistics (eq. 11 - 14 in paper) under the 
#' null hypothesis using this simulated data.
#' 
#' @param t length of sample size for simulation 
#' @param number of simulated samples
#' 
#' @return The four test statistics (eq. 11 - 14 in paper)
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
sim_DLmoments <- function(Tsize, N) {
    .Call(`_MSTest_sim_DLmoments`, Tsize, N)
}

#' @title Quantile-Based Test-Statistics From Simulated Data  
#'
#' @description 
#' 
#' @export
sim_Qmoments <- function(Tsize, N, mdl_h0, k1) {
    .Call(`_MSTest_sim_Qmoments`, Tsize, N, mdl_h0, k1)
}

#' @title Combine p-values 
#'
#' @description This function is used to combine the p-values as in eq 17 and 18 of Dufour & Luger (2017).
#' The input parameter \emph{type} can be used to used to specify the method for combining 
#' the pvalues. If set to "min" the min method of combining p-values is used as in Fisher (1932) 
#' and Pearson (1933). If set to "prod" the product of p-values is used as in Tippett (1931) 
#' and Wilkinson (1951).
#' 
#' @param s0 test-statistic under the alternative
#' @param sN test-statistics under the null
#' @param param output from \emph{approxDist} which obtains the parameters needed in eq. 16 which is used for 
#' combining p-values.
#' @param N total number of test statistics (i.e. simulated + observed = N)
#' @param type the type of method used to combine p-values. If set to "min" the min method of combining p-values is used as in Fisher (1932) 
#' and Pearson (1933). If set to "prod" the product of p-values is used as in Tippett (1931) 
#' and Wilkinson (1951).
#' 
#' @return The four test statistics (eq. 11 - 14 in paper)
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' @references Tippett, L. (1931). The Method of Statistics. London: Williams & Norgate.
#' @references Wilkinson, B. (1951). A statistical consideration in psychological research. 
#' Psychology Bulletin 48:156–158.
#' @references Pearson, K. (1933). On a method of determining whether a sample of size n
#'  supposed to have been drawn from a parent population having a known probability integral has probably been drawn at random. Biometrika 25:379–410.
#' @references Fisher, R. (1932). Statistical Methods for Research Workers. Edinburgh: 
#' Oliver and Boyd.
#' 
#' @export
combine_stat <- function(s0, sN, params, type) {
    .Call(`_MSTest_combine_stat`, s0, sN, params, type)
}

#' @title Calculate combined p-value test statistic 
#'
#' @description This function computes test-statistics for observed and simulated samples. 
#' It begins by calculating it for the obsted data, then generates test-statistics from 
#' simulated data to approximate null distribution and then calculates the p-values and 
#' combines them according to eq. 17 or 18 of Dufour & Luger (2017).
#' 
#' @param ezt observed series
#' @param N total number of test statistics (i.e. simulated + observed = N)
#' @param param output from \emph{approxDist} which obtains the parameters needed in eq. 16 which is used for 
#' combining p-values.
#' 
#' @return The four test statistics (eq. 11 - 14 in paper)
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
calc_DLmcstat <- function(ezt, N, params, type = "min") {
    .Call(`_MSTest_calc_DLmcstat`, ezt, N, params, type)
}

#' @title Calculate Quantile-Based Combined P-Value Test Statistic 
#'
#' 
#' @param ezt observed series
#' 
#' @export
calc_Qmcstat <- function(ezt, N, params, mdl_h0, k1, type = "min") {
    .Call(`_MSTest_calc_Qmcstat`, ezt, N, params, mdl_h0, k1, type)
}

#' @title Loop for \emph{approxDist}
#'
#' @description This function performs the loop in \emph{approxDist}. It is written in C++ for better 
#' performance in terms of speed.
#' 
#' @param SN2 matrix of Tx4 test-statistics
#' 
#' @return The four test statistics from smulated data in [0,1]. Used for NLS to get 
#' params needed to combine p-values
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export    
approx_dist_loop <- function(SN2) {
    .Call(`_MSTest_approx_dist_loop`, SN2)
}

#' @title Dufour & Luger (2017) moment-based MMC test p-value function to be minimized
#'
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
DLMMCpval_fun <- function(theta, y, x, N, simdist_N, pval_type, stationary_ind, lambda) {
    .Call(`_MSTest_DLMMCpval_fun`, theta, y, x, N, simdist_N, pval_type, stationary_ind, lambda)
}

#' @title Dufour & Luger (2017) moment-based MMC test p-value function to be maximized
#'
#' 
#' @references Dufour, J. M., & Luger, R. (2017). Identification-robust moment-based 
#' tests for Markov switching in autoregressive models. Econometric Reviews, 36(6-9), 713-727.
#' 
#' @export
DLMMCpval_fun_max <- function(theta, y, x, N, simdist_N, pval_type, stationary_ind, lambda) {
    .Call(`_MSTest_DLMMCpval_fun_max`, theta, y, x, N, simdist_N, pval_type, stationary_ind, lambda)
}

#' @title AR Log-likelihood objective function (used to find Hessian)
#' 
#' 
#' @export
loglik_fun <- function(theta, mdl) {
    .Call(`_MSTest_loglik_fun`, theta, mdl)
}

#' @title Fitting Autoregressive Model
#' 
#' @description This function estimates an autoregresive series
#' 
#' @param Y vector of observations
#' @param ar number of lags
#' @param intercept bool determines whether or not to include constant in estimation. Default is TRUE.
#' 
#' @return List with model characteristics which include
#' - y: transformed process
#' - X: matrix of lagged observations (with or without vector of 1s depending on const=1 or const=0)
#' - x: matrix of lagged observations without vector of 1s
#' - n: number of observations (T-ar)
#' - ar: number of autoregressive parameters
#' - coef: coefficient estimates. This is the same as phi is const=0
#' - phi: autoregressive coefficient estimates
#' - mu: the mean of the process
#' - residuals: vectot of residuals
#' - stdev: standard deviations
#' - se: standard errors of parameter estimtes
#' - logLike: the log-likelihood 
#' 
#' @export
ARmdl <- function(Y, ar, intercept = 1L, getSE = 0L) {
    .Call(`_MSTest_ARmdl`, Y, ar, intercept, getSE)
}

#' @title Fitting Vector Autoregressive Model
#' 
#' @description This function estimates a vector autoregresive series
#' 
#' @export
VARmdl <- function(Y, ar, intercept = 1L) {
    .Call(`_MSTest_VARmdl`, Y, ar, intercept)
}

#' @title Markov-switching AR Log-likelihood objective function (used to find Hessian)
#' 
#' 
#' @export
MSloglik_fun <- function(theta, mdl, k) {
    .Call(`_MSTest_MSloglik_fun`, theta, mdl, k)
}

#' @title Markov-switching AR Log-likelihood objective function Minization
#' 
#' 
#' @export
MSloglik_fun_min <- function(theta, mdl, k) {
    .Call(`_MSTest_MSloglik_fun_min`, theta, mdl, k)
}

#' @title Markov-switching Model equality constraint
#' 
#' 
#' @export
MSloglik_const_eq <- function(theta, mdl, k) {
    .Call(`_MSTest_MSloglik_const_eq`, theta, mdl, k)
}

#' @title Markov-switching Model Inequality Constraint
#' 
#' 
#' @export
MSloglik_const_ineq <- function(theta, mdl, k) {
    .Call(`_MSTest_MSloglik_const_ineq`, theta, mdl, k)
}

#' @title Markov-switching loglikelihood and Hamilton smoother
#' 
#' @description This function computes loglikelihood for Markov-switching models and computes the hamilton smoother.
#' 
#' @param mdl List containing relevant parameters.
#' @param theta vector with mean and variance in each regime.
#' @param P matrix with transition probabilities.
#' @param pinf limiting probabilities of each regime.
#' @param k number of regimes. Must be greater than or equal to 2. 
#'  
#' @return List with log-likelihood (loglik), and smoothed probabilities of each regime (xi_t_T).
#' 
#' @export
MSloglik <- function(theta, mdl, k) {
    .Call(`_MSTest_MSloglik`, theta, mdl, k)
}

#' @title EM Algo Maximization step
#' 
#' @description This function performs the maximization step of the Expectation Maximization (EM) algorithm.
#' 
#' @export
EMaximization <- function(theta, mdl, MSloglik_output, k) {
    .Call(`_MSTest_EMaximization`, theta, mdl, MSloglik_output, k)
}

#' @title Markov-switching loglikelihood and Hamilton smoother
#' 
#' @description This function computes loglikelihood for Markov-switching models and computes the hamilton smoother.
#' 
#' @param mdl List containing relevant parameters.
#' @param theta vector with mean and variance in each regime.
#' @param P matrix with transition probabilities.
#' @param pinf limiting probabilities of each regime.
#' @param k number of regimes. Must be greater than or equal to 2. 
#'  
#' @return List with log-likelihood (loglik), and smoothed probabilities of each regime (xi_t_T).
#' 
#' @export
MSVARloglik <- function(theta, mdl, k) {
    .Call(`_MSTest_MSVARloglik`, theta, mdl, k)
}

#' @title EM Algo Maximization step
#' 
#' @description This function performs the maximization step of the Expectation Maximization (EM) algorithm.
#' 
#' @export
VAREMaximization <- function(theta, mdl, MSloglik_output, k) {
    .Call(`_MSTest_VAREMaximization`, theta, mdl, MSloglik_output, k)
}

#' @title EM Algorithm 
#' 
#' @description This function performs a single iteration of the Expectation Maximization (EM) algorithm
#' 
#' @export
EMiter <- function(mdl, EMest_output, k) {
    .Call(`_MSTest_EMiter`, mdl, EMest_output, k)
}

#' @title EM Algorithm Iteration for VAR model
#' 
#' @description This function performs a single iteration of the Expectation Maximization (EM) algorithm
#' 
#' @export
EMiter_VAR <- function(mdl, EMest_output, k) {
    .Call(`_MSTest_EMiter_VAR`, mdl, EMest_output, k)
}

#' @title Estimation by EM Algorithm 
#' 
#' @description Estimated by the EM algorithm by calling the function EM() 
#' multiple times until convergence. Convergence is determined by a max number 
#' of iterations (maxit) or a convergence criterion. Specifically, the convergence 
#' criterion is the absolute difference between parameter estimates in adjacent 
#' iterations be less than 1.e-6 in absolute value. These can be changed by 
#' defining them in the optim_options List. 
#' 
#' @param z vector with observations.
#' @param k number of regimes. Must be greater than or equal to 2. 
#' @param msmu bool indicator for switch in mean (TRUE) or constant mean (FALSE). Default is TRUE.
#' @param msvar bool indicator for switch in variance (TRUE) or constant variance (FALSE). Default is TRUE.
#' @param theta_0  vector with initial values for mean and variance parameters in each state (e.g. theta_0 = c(mu_1, mu_2,..., mu_K, var_1, var_2, ..., var_K)). If NULL then initVal() is used to generate initial values. Default is NULL.
#' @param P_0 matrix with initial values for transition matrix P. Is NULL, randTransMat() is used to generate a random transition matrix. Default is NULL.
#' @param optim_options List with optimization options. When not specified (i.e. NULL), the max number of EM iterations is 200 and the convergence criterion is 1.e-6. Default is NULL.
#' 
#' @return List with model results
#' 
#' @export
EMest <- function(theta_0, mdl, k, optim_options) {
    .Call(`_MSTest_EMest`, theta_0, mdl, k, optim_options)
}

#' @title Estimation of MSVAR by EM Algorithm 
#' 
#' 
#' @export
EMest_VAR <- function(theta_0, mdl, k, optim_options) {
    .Call(`_MSTest_EMest_VAR`, theta_0, mdl, k, optim_options)
}

#' @title Markov-switching Autoregressive (AR) model
#' 
#' @description This function estimates a Markov-switching autoregressive (AR) model. 
#' This function uses the EM algorithm and has the option to use an optimization method 
#' as a second step to improve estimates. The function also allows the mean and/or the 
#' variance to switch but the autoregressive parameters remain constant accross regimes.
#' 
#' @param Y (Tx1) vector with observational data. Required argument.
#' @param p integer for the number of lags to use in estimation. Must be greater than or equal to 0. Default is 0.
#' @param k integer for the number of regimes to use in estimation. Must be greater than or equal to 2. Default is 2.
#' @param msmu bool indicator for switch in mean (TRUE) or constant mean (FALSE). Default is TRUE.
#' @param msvar bool indicator for switch in variance (TRUE) or constant variance (FALSE). Default is TRUE.
#' @param theta_0  vector with initial values for mean and variance parameters in each state (e.g. theta_0 = c(mu_1, mu_2,..., mu_K, var_1, var_2, ..., var_K)). If NULL then initVal() is used to generate initial values. Default is NULL.
#' @param P_0 matrix with initial values for transition matrix P. Is NULL, randTransMat() is used to generate a random transition matrix. Default is NULL.
#' @param optim_options List with optimization options. When not specified (i.e. NULL), the max number of EM iterations is 200 and the convergence criterion is 1.e-6. Default is NULL.
#' 
#' @return List with model characteristics including:
#' - y: transformed process
#' - X: matrix of lagged observations (with or without vector of 1s depending on const=1 or const=0)
#' - x: matrix of lagged observations without vector of 1s
#' - n: number of observations (T-ar)
#' - ar: number of autoregressive parameters
#' - coef: coefficient estimates. This is the same as phi is const=0
#' - phi: autoregressive coefficient estimates
#' - mu: the mean of the process
#' - residuals: vectot of residuals
#' - stdev: standard deviations
#' - se: standard errors of parameter estimtes
#' - logLike: the log-likelihood 
#' 
#' @export
MSARmdl <- function(Y, ar, k, msmu = 1L, msvar = 1L, maxit = 10000L, thtol = 1.e-6, getHess = 0L, max_init = 500L, use_diff_init = 1L, init_value = NULL) {
    .Call(`_MSTest_MSARmdl`, Y, ar, k, msmu, msvar, maxit, thtol, getHess, max_init, use_diff_init, init_value)
}

#' @title Markov-switching Vector Autoregressive (VAR) model
#' 
#' @export
MSVARmdl <- function(Y, ar = 1L, k = 2L, msmu = 1L, msvar = 1L, maxit = 10000L, thtol = 1.e-8, getHess = 0L, max_init = 100L) {
    .Call(`_MSTest_MSVARmdl`, Y, ar, k, msmu, msvar, maxit, thtol, getHess, max_init)
}

